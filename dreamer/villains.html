<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Villains - DEANSand</title>
  <style>
    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      min-height: 100%;
      background: #1a1a2e; /* Fallback if video doesn't load */
      font-family: Georgia, serif;
    }

    /* VIDEO BACKGROUND */
    .video-wrapper {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      /*overflow: hidden;*/
      z-index: 0;
      pointer-events: none;
    }

    .video-bg {
      position: absolute;
      top: 50%;
      left: 50%;
      min-width: 100%;
      min-height: 100%;
      width: auto;
      height: auto;
      transform: translate(-50%, -50%);
      object-fit: cover;
      filter: blur(2px) brightness(0.95) contrast(1.1);
      opacity: 0.99;
      pointer-events: none;
      transition: transform 0.3s ease;
    }

    /* Return button */
    .return-button {
      position: fixed;
      top: 20px;
      left: 20px;
      background: white;
      color: black;
      padding: 10px 18px;
      border-radius: 5px;
      text-decoration: none;
      z-index: 2000;
      transition: background 0.3s ease, color 0.3s ease;
    }

    .return-button:hover {
      background: red;
      color: white;
    }

    /* Ensure content is above video */
    .game-container,
    .result-wrapper {
      position: relative;
      z-index: 1;
    }

    /* ============================================
       GAME CONTAINER - Selection Phase
       ============================================ */
    .game-container {
      width: 100%;
      min-height: 100vh;
      padding-top: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .cards-row {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-evenly;
      padding: 2%;
    }

    /* Card slot - 30% width, aspect ratio preserved */
    .card-slot {
      width: 30%;
      aspect-ratio: 1218 / 1698;
      position: relative;
    }

    .card {
      width: 100%;
      height: 100%;
      cursor: pointer;
      perspective: 1200px;
      position: relative;
      transition: transform 0.3s ease;
      border-radius: 23px;
      /*overflow: hidden;*/
    }

    .card:hover {
      transform: scale(1.03);
    }

    .card-inner {
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 0.6s ease;
      position: relative;
    }

    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    .card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 23px;
      box-shadow: 0 12px 30px rgba(222,20,160,0.35);
      /*overflow: hidden;*/
      background: #222;
    }

    .card-back {
      transform: rotateY(0deg);
    }

    .card-front {
      transform: rotateY(180deg);
      background: #fff;
    }

    .card-face img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    /* ============================================
       RESULT PHASE - Card + Floating Text
       ============================================ */
    .result-wrapper {
      display: none;
      width: 100%;
      min-height: 100vh;
      padding: 80px 2% 40px 2%;
    }

    .result-wrapper.active {
      display: flex;
      flex-wrap: wrap;
      align-items: flex-start;
      justify-content: center;
      gap: 3%;
    }

    /* Result card - 30% width, floats left */
    .result-card {
      width: 30%;
      aspect-ratio: 1218 / 1698;
      flex-shrink: 0;
    }

    .result-card .card {
      width: 100%;
      height: 100%;
      cursor: default;
    }

    /* Floating text card - floats right of the card */
    .floating-text-card {
      flex: 1;
      min-width: 300px;
      max-width: 55%;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 12px 24px rgba(0,0,0,0.2);
      max-height: 80vh;
      overflow-y: auto;
    }

    .floating-text-card .char-name {
      font-size: clamp(24px, 3vw, 36px);
      color: #333;
      margin: 0 0 20px 0;
    }

    .floating-text-card .char-desc {
      font-size: clamp(15px, 1.6vw, 18px);
      line-height: 1.8;
      color: #444;
      margin: 0;
    }

    /* Fade out animation for non-selected cards */
    .fade-out {
      animation: fadeAway 0.4s ease forwards;
      pointer-events: none;
    }

    @keyframes fadeAway {
      from { opacity: 1; transform: scale(1); }
      to   { opacity: 0; transform: scale(0.7); }
    }

    /* Selected card - fixed position for animation */
    .card.selected {
      position: fixed !important;
      z-index: 1000;
      pointer-events: none;
      transition: left 0.8s cubic-bezier(0.22, 0.9, 0.34, 1),
                  top 0.8s cubic-bezier(0.22, 0.9, 0.34, 1),
                  width 0.6s ease,
                  height 0.6s ease;
    }

    /* ============================================
       VERTICAL MODE (< 700px)
       Cards height = 30% of viewport, stack vertically
       ============================================ */
    @media (max-width: 700px) {
      .game-container {
        align-items: flex-start;
        padding-top: 80px;
      }

      .cards-row {
        flex-direction: column;
        align-items: center;
        gap: 15px;
        padding: 3%;
      }

      /* In vertical mode: height = 30vh, width auto-calculated */
      .card-slot {
        width: auto;
        height: 30vh;
        aspect-ratio: 1218 / 1698;
      }

      /* Result wrapper stacks vertically */
      .result-wrapper.active {
        flex-direction: column;
        align-items: center;
        gap: 20px;
        padding: 80px 5% 40px 5%;
      }

      /* Result card - height limited to 40vh in vertical mode */
      .result-card {
        width: auto;
        height: 40vh;
        aspect-ratio: 1218 / 1698;
      }

      /* Text card goes below, full width, scrollable */
      .floating-text-card {
        width: 90%;
        max-width: none;
        min-width: auto;
        max-height: none;
        overflow-y: visible;
      }
    }
    @media (min-width: 901px) {  .card-face { border-radius: 36px;  }  }
  </style>
</head>
<body>
  <!-- VIDEO BACKGROUND -->
  <div class="video-wrapper">
    <video class="video-bg" autoplay muted loop playsinline>
      <source src="../media/138556-769988117_medium.mp4" type="video/mp4" />
      Your browser does not support the video tag.
    </video>
  </div>

  <a class="return-button" href="../dreamer.html">Return To Dreaming</a>

  <!-- SELECTION PHASE -->
  <div class="game-container" id="gameContainer">
    <div class="cards-row" id="cardsRow">
      <div class="card-slot">
        <div class="card" id="card1">
          <div class="card-inner">
            <div class="card-face card-back">
              <img id="back1" src="../P986/cards/backs/020_back.webp" alt="Card Back">
            </div>
            <div class="card-face card-front">
              <img id="front1" src="../P986/cards/fronts/020.webp" alt="Card Front">
            </div>
          </div>
        </div>
      </div>

      <div class="card-slot">
        <div class="card" id="card2">
          <div class="card-inner">
            <div class="card-face card-back">
              <img id="back2" src="../P986/cards/backs/020_back.webp" alt="Card Back">
            </div>
            <div class="card-face card-front">
              <img id="front2" src="../P986/cards/fronts/020.webp" alt="Card Front">
            </div>
          </div>
        </div>
      </div>

      <div class="card-slot">
        <div class="card" id="card3">
          <div class="card-inner">
            <div class="card-face card-back">
              <img id="back3" src="../P986/cards/backs/020_back.webp" alt="Card Back">
            </div>
            <div class="card-face card-front">
              <img id="front3" src="../P986/cards/fronts/020.webp" alt="Card Front">
            </div>
          </div>
        </div>
      </div>
    </div>  
  </div>

  <!-- RESULT PHASE -->
  <div class="result-wrapper" id="resultWrapper">
    <div class="result-card" id="resultCard"></div>
    <div class="floating-text-card" id="floatingText">
      <h2 class="char-name" id="charName"></h2>
      <p class="char-desc" id="charDesc"></p>
    </div>
  </div>

  <script>
  const characterData = {
    "020": { 
  name: "Angelo Adair, The Distillery Baron", 
  description: "Lead developer and engineer of soulgem distilleries; maniac. Empowers with soulgems. \"I am the architect. Every step I take brings us closer to godhood.\"" },
    "021": { 
  name: "Byron vey Byornn, The Commander", 
  description: "Commander of mageknight legion. Famous family name. Paranoid, delusions of grandeur. Extreme strength, basic light sorcery. \"We will have peace, order, justice in my lifetime. I'll raise that sun myself.\"" },
    "022": { 
  name: "Ceng Zhangyi, The Artifice Scholar", 
  description: "Expert in mixed martial arts; researches artifacts and Jade Empire. Jade Empire supremacist. Uses basic artifacts. \"Technology is our salvation. The answers, the truth of it all.\"" },
    "023": { 
  name: "Daisuke Daioh, The Artificer", 
  description: "Seasoned veteran of anti-rebellion battles; protects the status-quo. Elitism; royal supremacist. Uses gemstone powered artifacts. \"Find something that makes you powerful and stick to it.\"" },
    "024": { 
  name: "Elizabeth Einsborough, The Royal Politician", 
  description: "Founder and financier of sorcery academies; human trafficker. Retired sorceress. Well-connected. May use advanced magicks. \"Ha! My time is worth more than yours, I guarantee it; pay up or get out.\"" },
    "025": { 
  name: "Fal, The Shaman", 
  description: "Protector of Nyx. Superstitious, practices rituals and sacrifice; alchemist and hedonist. May use moon, blood, mist magicks. \"I'll carve you, make you mine forever. Stop squirming, little doll.\"" },
    "026": { 
  name: "Gary Gigantes, The Smuggler", 
  description: "Drug baron. Ruthless, cunning. Financier of Opal Cities United. Prefers run-and-gun guerilla tactics. Old, but proficient fencer; crossbows. \"I've got an empire of my own to keep afloat. You understand, dont you?\"" },
    "027": { 
  name: "Hyunjin Halvela, The Bountyhunter", 
  description: "Expert improviser; legendary killer. Moves instantly when unseen. Knows when to withdraw. May evade any attack; counterattack. \"Nothing personal. Hush.\"" },
    "028": { 
  name: "Isaac Ivanson, The Moonworm Mage", 
  description: "Longest surviving worm host. Insane. Talks to himself, communicates with moon and other entities. May use advanced moon, mist, worm spells; can summon wormridden things. \"If you knew what I knew, youd be me!\"" },
    "029": { 
  name: "JJ The Beast, The Boss", 
  description: "Powerful family of multiple industries. Wealthy. Cunning. Power increases as health decreases. Extreme speed. Melee doublestrike. \"Bizarre? Golden.\"" },
    "030": { 
  name: "Kleo, The Politician", 
  description: "Strives for equal rights for the Anim people-- at any cost. Master manipulator, cunning. Moves at every possible moment. \"I spend my time playing their games so they fall into mine.\"" },
    "031": { 
  name: "Li, The Fanatic", 
  description: "Fanatic to the Crimson Cause. Expert in devilarms; firearms. Spreads gospel, recruits others. Must always resolve when acting. \"By my hand, it shall be done.\"" },
    "032": { 
  name: "Maelle, The Commander", 
  description: "Commander of a Crimson Faction. Expert in devilarms; firearms. Adept in counterspells, antimagicks. Despite armour, excellent acrobatics. \"We rise, we go, we paint the world anew. That is the Crimson Cause.\"" },
    "033": { 
  name: "Neville Schwarz, The Fanatic", 
  description: "Shadow actor, usurper, and dealer for the Crimson Cause. Expert in illusory techniques, deception, and distraction. Uses poisons and other tools. \"Wrapped in ink, I snuff out the blinding light.\"" },
    "034": { 
  name: "Olum Farhoud, The Herald", 
  description: "Wanders the lands, aligning sub-religions to one religion. Adept in lightning and fire magicks. Knowledge of environments. \"Extend. Consume. Extinguish.\"" },
    "035": { 
  name: "Paarth Lomedi, The Politician", 
  description: "Political representative of the Crimson Cause. Owns lands, businesses, resources in kingdoms. Clever. Blackmail enthusiast. \"The people and places marching with us? Dried grasses ready to ignite.\"" },
    "036": { 
  name: "Qing, The Spy", 
  description: "Extremespeed; apex momentum. Can be swooned or persuaded. Swears oath to one master. Small projectiles and tools. Mysterious. \"Information is the deadliest substance. Knives and poison are second best.\"" },
    "037": { 
  name: "Reeve Basilisk, The Lord", 
  description: "Seasoned veteran of the old war and smaller battles. Earned lordship via victory in combat. Access to high light spells; punches stun or blind. \"Order, and prosperity. I will hammer you down, your corpses build the future.\"" },
    "038": { 
  name: "Vincent, The Gallant Fencer", 
  description: "Summons and empowers Kyth. Commands wormridden creatures; resolve to regain control. Moon magicks and agile combat. \"As you see, we think quite differently.\"" },
    "039": { 
  name: "Taeonora, The Pariah", 
  description: "Hails from beyond the ocean. Intentions unknown. Overwhelmingly powerful aura; must resolve all actions against Taeonora. \"One who knows nothing can understand nothing.\"" }
  };
  

  function getRandomNumber(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function formatCardNumber(num) {
    return num.toString().padStart(3, '0');
  }

  function extractIDFromSrc(src) {
    const match = src.match(/(\d{3})\.webp$/);
    return match ? match[1] : null;
  }

  function isVerticalMode() {
    return window.innerWidth <= 700;
  }

  let chosenAlready = false;

  function initializeCards() {
    const used = new Set();
    for (let i = 1; i <= 3; i++) {
      let num;
      do { num = getRandomNumber(20, 39); } while (used.has(num));
      used.add(num);
      const formatted = formatCardNumber(num);
      document.getElementById(`back${i}`).src = `../P986/cards/backs/${formatted}_back.webp`;
      document.getElementById(`front${i}`).src = `../P986/cards/fronts/${formatted}.webp`;
      const card = document.getElementById(`card${i}`);
      card.dataset.cardNumber = formatted;
      card.classList.remove('flipped', 'fade-out');
    }
    // Reset UI
    document.getElementById('gameContainer').style.display = '';
    document.getElementById('resultWrapper').classList.remove('active');
    document.getElementById('resultCard').innerHTML = '';
    chosenAlready = false;
  }

  function selectCard(cardEl) {
    if (chosenAlready) return;
    chosenAlready = true;

    // Fade out other cards
    const allCards = document.querySelectorAll('.card');
    allCards.forEach(card => {
      if (card !== cardEl) {
        card.classList.add('fade-out');
      }
    });

    // Get starting position
    const startRect = cardEl.getBoundingClientRect();

    // Calculate target position (left side, vertically centered)
    let targetLeft, targetTop, targetWidth, targetHeight;
    if (isVerticalMode()) {
      // Vertical mode: center-top
      targetWidth = window.innerHeight * 0.4 * (1218 / 1698); // 40vh height, maintain aspect ratio
      targetHeight = window.innerHeight * 0.4;
      targetLeft = (window.innerWidth - targetWidth) / 2;
      targetTop = 90;
    } else {
      // Desktop: left side, 30% width
      targetWidth = window.innerWidth * 0.30;
      targetHeight = targetWidth * (1698 / 1218);
      targetLeft = window.innerWidth * 0.05;
      targetTop = (window.innerHeight - targetHeight) / 2;
    }

    // Set initial fixed position (current location)
    cardEl.style.position = 'fixed';
    cardEl.style.left = startRect.left + 'px';
    cardEl.style.top = startRect.top + 'px';
    cardEl.style.width = startRect.width + 'px';
    cardEl.style.height = startRect.height + 'px';
    cardEl.style.margin = '0';
    cardEl.classList.add('selected');

    // Move card to body for proper fixed positioning
    document.body.appendChild(cardEl);

    // Animate to target position
    requestAnimationFrame(() => {
      cardEl.style.left = targetLeft + 'px';
      cardEl.style.top = targetTop + 'px';
      cardEl.style.width = targetWidth + 'px';
      cardEl.style.height = targetHeight + 'px';
    });

    // Flip card after slide animation
    setTimeout(() => {
      cardEl.classList.add('flipped');
    }, 600);

    // Get character data
    const frontImg = cardEl.querySelector('.card-front img');
    const id = extractIDFromSrc(frontImg.src);
    const data = characterData[id] || { 
  name: 'Unknown', 
  description: 'No data available.' };

    // Transition to result view after animations complete
    setTimeout(() => {
      // Hide game container and animated card
      document.getElementById('gameContainer').style.display = 'none';
      cardEl.style.display = 'none';

      // Clone the card into result area
      const resultCard = document.getElementById('resultCard');
      const cardClone = cardEl.cloneNode(true);
      cardClone.classList.remove('selected', 'fade-out');
      cardClone.classList.add('flipped');
      cardClone.style.cssText = ''; // Clear inline styles
      cardClone.style.cursor = 'default';
      resultCard.innerHTML = '';
      resultCard.appendChild(cardClone);

      // Set text content
      document.getElementById('charName').textContent = data.name;
      document.getElementById('charDesc').innerHTML = data.description;

      // Show result wrapper
      document.getElementById('resultWrapper').classList.add('active');
    }, 1400);
  }

  function addCardListeners() {
    const cards = document.querySelectorAll('#gameContainer .card');
    cards.forEach(card => {
      card.addEventListener('click', () => selectCard(card));
    });
  }

  window.addEventListener('load', () => {
    initializeCards();
    addCardListeners();
  });
  </script>
</body>
</html>
