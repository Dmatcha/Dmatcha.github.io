<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>The NIGHT — Redesigned</title>
  <style>
    /* -------------------------
       Base / Reset
       ------------------------- */
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family: "Georgia", serif;
      background: linear-gradient(135deg,#1a1a2e 0%, #16213e 40%, #0f3460 100%);
      color:#e8e8e8;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      overflow-y:auto;
    }
body {
  background: linear-gradient(135deg,#1a1a2e 0%, #16213e 40%, #0f3460 100%);
  background-repeat: no-repeat;   /* STOP repeating */
  background-attachment: fixed;   /* Stays in place while scrolling */
  background-size: cover;         /* Fills whole viewport */
}
    /* -------------------------
       Top fixed bar
       ------------------------- */
    .top-bar{
      position:fixed;
      top:0;
      left:0;
      width:100%;
      height:64px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:0 28px;
      gap:12px;
      z-index:1000;
      backdrop-filter: blur(6px) saturate(.9);
      background: linear-gradient(180deg, rgba(26,26,46,0.95), rgba(16,33,62,0.8));
      border-bottom:1px solid rgba(255,255,255,0.08);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    }

    .bar-left, .bar-right { display:none; }
    .bar-center { display:flex; }
    
    /* Desktop top row layout */
    .top-row { 
      display: flex;
      align-items: center;
      gap: 12px;
      width: 100%;
      justify-content: space-between;
    }

    /* Return button */
    .return-btn{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 16px;
      border-radius:8px;
      cursor:pointer;
      text-decoration:none;
      font-weight:700;
      background:rgba(255,255,255,0.1);
      color:#ffffff;
      border:2px solid rgba(255,255,255,0.15);
      transition: background .22s ease, color .22s ease, transform .12s ease, border-color .22s ease;
    }
    .return-btn:hover,
    .return-btn:focus{
      background:#e94560; /* crimson red */
      color:#fff;
      border-color:#e94560;
      outline:none;
      transform:translateY(-1px);
      box-shadow:0 8px 20px rgba(233,69,96,0.25);
    }

    /* Title */
    .title {
      font-size:20px;
      letter-spacing:2px;
      font-weight:800;
      text-align:center;
      color:#f0f0f0;
      text-transform:uppercase;
      padding:6px 12px;
      position:relative;
    }
    .title::after{
      content:"";
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      bottom:-8px;
      width:60px;
      height:6px;
      border-radius:6px;
      background:linear-gradient(90deg,#4a4a8a,#6a6aaa);
      filter:drop-shadow(0 6px 16px rgba(106,106,170,0.3));
      opacity:.85;
    }

    /* Info (?) button */
    .info-btn{
      width:44px;height:44px;border-radius:10px;border:none;
      background:transparent;cursor:pointer;font-weight:700;
      display:inline-grid;place-items:center;font-size:18px;
      color:#f0f0f0;
      transition:transform .12s ease, background .12s ease;
    }
    .info-btn:hover{ transform:translateY(-1px); background: rgba(255,255,255,0.08); }

    /* -------------------------
       Main layout (Widescreen >=800px)
       ------------------------- */
    .page-inner{
      max-width:1200px;
      margin: 96px auto 80px; /* leave room for fixed bar */
      padding: 28px;
    }

    .suns-row{
      display:flex;
      gap:28px;
      align-items:flex-start;
      justify-content:space-between;
    }

    /* Sun capsule (default) and expanded panel */
    .sun {
      flex:1 1 0;
      min-width:260px;
      max-width:360px;
      display:flex;
      flex-direction:column;
      align-items:center;
      transition: transform .45s cubic-bezier(.2,.9,.28,1), opacity .35s ease;
      will-change: transform, opacity;
      position:relative;
    }

    /* The glowing ball - now SVG-based */
    .sun .orb {
      width:180px;height:180px;border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      transition: transform .35s ease, box-shadow .35s ease, filter .35s ease;
      animation: floatOrb 4.5s ease-in-out infinite;
      user-select:none;
    }
    .sun .orb:hover{ transform: scale(1.06); }
    .sun .orb svg { transition: transform .35s ease, filter .35s ease; }
    .sun .orb:hover svg{ filter:brightness(1.04) saturate(1.03); }

    @keyframes floatOrb {
      0%{ transform: translateY(0) }
      50%{ transform: translateY(-8px) }
      100%{ transform: translateY(0) }
    }

    /* Orb label below */
    .sun .label {
      margin-top:8px;
      font-weight:800;
      text-transform:uppercase;
      letter-spacing:1px;
      color:#f0f0f0;
      font-size:14px;
    }

    /* Expanded panel */
    .panel {
      position: relative;
      width: 100%;
      margin-top: 18px;
      border-radius: 14px;
      overflow: hidden;
      background: linear-gradient(180deg, rgba(40,40,60,0.95), rgba(30,30,50,0.98));
      box-shadow: 0 18px 40px rgba(0,0,0,0.4);
      transform-origin: top center;
      opacity: 0;
      max-height: 0;
      padding: 0 22px;
      border: 1px solid rgba(255,255,255,0.08);
      transition:
        opacity .4s ease,
        max-height .75s ease;   /* slowed for smoother expansion */
    }

    /* when expanded */
    .sun.expanded .panel {
      opacity: 1;
      max-height: 2000px;        /* HIGH VALUE to allow full text height */
      padding: 18px 22px 30px;
    }

    /* when expanded */
    .sun.expanded{
      transform:translateY(-2px) scale(1.02);
      z-index:30;
    }

    /* Close button (top-left inside panel) */
    .close-x{
      position:absolute;
      left:14px;
      top:14px;
      width:36px;height:36px;border-radius:8px;
      display:inline-grid;place-items:center;
      cursor:pointer;border:none;background:transparent;font-weight:700;
      color:#f0f0f0;
      transition: transform .12s ease;
    }
    .close-x:hover{ transform:translateY(-2px); background: rgba(255,255,255,0.08); }

    /* Panel title */
    .panel .panel-title{
      text-transform:uppercase;
      font-weight:900;
      letter-spacing:1.5px;
      font-size:18px;
      margin-left:58px; /* leave space for close button */
      margin-bottom:12px;
      color:#f0f0f0;
    }

    /* Image with faded/dissolved top border */
    .panel .fade-image{
      width:100%;
      height:220px;
      border-radius:10px;
      object-fit:cover;
      display:block;
        mask-image: radial-gradient(circle, 
            rgba(0,0,0,1) 40%, 
            rgba(0,0,0,0.5) 70%, 
            rgba(0,0,0,0) 100%
        );
        -webkit-mask-image: radial-gradient(circle, 
            rgba(0,0,0,1) 40%, 
            rgba(0,0,0,0.5) 70%, 
            rgba(0,0,0,0) 100%
        );
      box-shadow: inset 0 30px 60px rgba(0,0,0,0.2);
      margin-bottom:14px;
      background:linear-gradient(180deg,#2a2a3e,#1a1a2e);
    }

    /* Text area */
    .panel .panel-body {
      font-size:15px;
      line-height:1.6;
      color:#d0d0d0;
    }
    .panel .panel-body p{ margin-bottom:12px }
    .panel .panel-body ul{ margin-left:18px; margin-bottom:12px }
    .panel .panel-body li{ margin-bottom:6px }

    /* When another orb is expanded, all others fully fade & slide down */
    .sun.dimmed{
      opacity: 0;                 /* fully invisible */
      transform: translateY(60px) scale(.94);
      pointer-events: none;
      filter: blur(4px);          /* optional atmospheric blur */
      transition:
        opacity .45s ease,
        transform .55s cubic-bezier(.2,.9,.28,1),
        filter .35s ease;
    }
    /* -------------------------
       Tablet and mobile screens
       ------------------------- */
    @media (max-width: 800px) {
      .page-inner{ margin:120px 18px 48px }
      .suns-row{flex-direction:column; gap:18px}
      .sun{max-width:100%}
      .sun .orb{ width:140px;height:140px; }
      .panel .fade-image{ height:160px }
      
      /* Mobile top bar layout - stacked layout */
      .top-bar{
        height: auto;
        min-height: 96px;
        padding: 12px 18px;
        flex-direction: column;
        gap: 12px;
        align-items: stretch;
      }
      
      /* Make top-bar children stack properly on mobile */
      .top-bar > * {
        width: 100%;
      }
      
      /* Desktop layout elements are already hidden */
      
      /* Mobile top row styling */
      .top-row {
        display: flex !important;
        justify-content: space-between;
        align-items: center;
        width: 100%;
        padding: 0;
      }
      
      /* Show and center title on mobile */
      .top-bar .bar-center {
        display: flex;
        position: static;
        transform: none;
        width: 100%;
        justify-content: center;
        margin: 0;
        order: 2; /* Put title below the buttons on mobile */
      }
      
      /* Adjust top-row order for mobile */
      .top-bar .top-row {
        order: 1; /* Put buttons on top for mobile */
      }
      
      .title {
        font-size: 18px;
        letter-spacing: 1.5px;
        margin: 0;
      }
      
      /* Return button styling on mobile */
      .top-row .return-btn {
        padding: 8px 12px;
        font-size: 14px;
        margin: 0;
        display: inline-flex !important;
        visibility: visible !important;
        opacity: 1 !important;
      }
      
      /* Info button styling on mobile */
      .top-row .info-btn {
        width: 40px;
        height: 40px;
        font-size: 16px;
        margin: 0;
        display: inline-grid !important;
        visibility: visible !important;
        opacity: 1 !important;
      }
    }

    .sun.dimmed .orb{
      filter: brightness(1.4) blur(10px);
    }
/*    .top-bar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 64px;
      display: flex;
      align-items: center;
      justify-content: space-between; // keep left/right in place 
      padding: 0 28px;
      gap: 12px;
      z-index: 1000;
      backdrop-filter: blur(6px) saturate(.9);
      background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.6));
      border-bottom: 1px solid rgba(0,0,0,0.06);
      box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    }*/

    /* PERFECT CENTERING FIX */
    .bar-center {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }

  </style>
</head>
<body>

  <!-- Top bar -->
  <header class="top-bar" role="banner" aria-label="Top navigation">
    <div class="top-row">
      <a href="../dreamer.html" class="return-btn" title="Return To Dreaming…">← Return To Dreaming…</a>
      <button class="info-btn" id="openInfo" aria-expanded="false" aria-controls="infoPanel" title="More information">?</button>
    </div>

    <div class="bar-center">
      <div class="title" aria-hidden="true">THE NIGHT</div>
    </div>
  </header>

  <!-- Supplemental info modal/panel -->
  <div id="infoPanel" role="dialog" aria-modal="true" aria-hidden="true"
       style="position:fixed; right:22px; top:80px; width:360px; max-width:calc(100% - 48px); z-index:1200;
              border-radius:12px; background:linear-gradient(180deg,#2a2a3e,#1a1a2e); padding:18px; box-shadow:0 20px 60px rgba(0,0,0,0.6); border:1px solid rgba(255,255,255,0.1); display:none;">
    <button id="closeInfo" style="position:absolute; right:10px; top:10px; border:none; background:transparent; cursor:pointer; font-weight:700; color:#f0f0f0;">✕</button>
    <h3 style="margin-bottom:8px; font-size:16px; text-transform:uppercase; letter-spacing:1px; color:#f0f0f0;">About The Night</h3>
    <p style="font-size:14px; line-height:1.5; color:#d0d0d0;">
      This panel holds supplemental context and worldbuilding for "The Night".
      Click any moon to expand its chapter. When one expands, the others fade and slide down to emphasise the active chapter.
    </p>
  </div>

  <main class="page-inner" id="main" role="main">
    <section class="suns-row" aria-label="Chapters of the night">

      <!-- THE DUSK -->
      <article class="sun" id="dusk" data-key="dusk" aria-labelledby="dusk-label">
        <!-- The Dusk moon SVG -->
        <svg class="orb" width="180" height="180" viewBox="0 0 512 512" role="button" tabindex="0" aria-pressed="false" aria-label="Open The Dusk">
          <defs><filter id="shadow-1" height="300%" width="300%" x="-100%" y="-100%"><feFlood flood-color="rgba(189, 16, 224, 1)" result="flood"></feFlood><feComposite in="flood" in2="SourceGraphic" operator="atop" result="composite"></feComposite><feGaussianBlur in="composite" stdDeviation="15" result="blur"></feGaussianBlur><feOffset dx="0" dy="0" result="offset"></feOffset><feComposite in="SourceGraphic" in2="offset" operator="over"></feComposite></filter><radialGradient id="lorc-moon-gradient-0"><stop offset="0%" stop-color="#9013fe" stop-opacity="1"></stop><stop offset="100%" stop-color="#000000" stop-opacity="1"></stop></radialGradient></defs><circle cx="256" cy="256" r="251" fill="url(#lorc-moon-gradient-0)" stroke="#bd10e0" stroke-opacity="1" stroke-width="5"></circle><g class="" transform="translate(0,0)" style=""><path d="M253.125 18.563c-131.53 0-238.375 106.813-238.375 238.343 0 131.53 106.846 238.344 238.375 238.344 131.53 0 238.344-106.815 238.344-238.344 0-131.528-106.816-238.344-238.345-238.344zm-23.938 52.093c40.517 0 77.988 12.904 108.532 34.813a154.099 154.099 0 0 0-17.064-.97c-84.157 0-152.375 68.25-152.375 152.406 0 84.157 68.22 152.375 152.376 152.375 5.762 0 11.467-.313 17.063-.936-30.545 21.91-68.016 34.812-108.533 34.812-102.98 0-186.28-83.272-186.28-186.25 0-102.977 83.3-186.25 186.28-186.25z" fill="#ffffff" fill-opacity="1" transform="translate(0, 0) scale(1, 1) rotate(90, 256, 256) skewX(0) skewY(0)" filter="url(#shadow-1)"></path></g>
        </svg>
        <div class="label" id="dusk-label">The Dusk</div>

        <div class="panel" aria-hidden="true">
          <button class="close-x" aria-label="Close The Dusk">✕</button>
          <div class="panel-title">The Dusk</div>
          <!-- image: replace src with your own; masked to fade near top -->
          <img class="fade-image" alt="Dusk image" src="..\media\sunset2.webp?q=80&w=1600&auto=format&fit=crop&ixlib=rb-4.0.3&s=5f6b4a6c6f79c2b2f9d2c79e2d5d9b0d">
          <div class="panel-body">
            <p><strong>SUNSET</strong>: After concluding the eleventh space, the next player will make a decision.</p>
            <p>PROCEED to...</p>
            <ul>
              <li>DAWN: conclude the current cycle and move to the next cycle.</li>
              <li>Resolve any effects.</li>
              <li>The player whom decided to proceed to DAWN takes their turn immediately after DAWN is concluded.</li>
              <li>NIGHT: begin the NIGHT phase.</li>
              <li>Night effects on map cards must be activated.</li>
              <li>Night effects for players activate immediately or on the beginning of their turn.</li>
              <li>The player whom decided to enter the NIGHT takes their turn immediately.</li>
            </ul>
            <p><em>Notes:</em> The narrator may enhance the difficulty of A/B/C cards at night arbitrarily.</p>
          </div>
        </div>
      </article>

      <!-- The Dark -->
      <article class="sun" id="fullmoon" data-key="fullmoon" aria-labelledby="fullmoon-label">
        <!-- The Dark SVG -->
        <svg class="orb" width="180" height="180" viewBox="0 0 512 512" role="button" tabindex="0" aria-pressed="false" aria-label="Open The Dark">
          <defs><filter id="shadow-1" height="300%" width="300%" x="-100%" y="-100%"><feFlood flood-color="rgba(252, 136, 252, 1)" result="flood"></feFlood><feComposite in="flood" in2="SourceGraphic" operator="atop" result="composite"></feComposite><feGaussianBlur in="composite" stdDeviation="15" result="blur"></feGaussianBlur><feOffset dx="0" dy="0" result="offset"></feOffset><feComposite in="SourceGraphic" in2="offset" operator="over"></feComposite></filter><radialGradient id="lorc-night-sky-gradient-0"><stop offset="0%" stop-color="#000000" stop-opacity="1"></stop><stop offset="100%" stop-color="#9013fe" stop-opacity="1"></stop></radialGradient></defs><circle cx="256" cy="256" r="249" fill="url(#lorc-night-sky-gradient-0)" stroke="#000000" stroke-opacity="1" stroke-width="7"></circle><g class="" transform="translate(0,0)" style=""><path d="M253.813 15.625c-132.32 0-239.782 107.46-239.782 239.78s107.463 239.782 239.782 239.782c132.32 0 239.782-107.46 239.782-239.78S386.132 15.624 253.814 15.624zm0 17.906c122.653 0 221.906 99.223 221.906 221.876 0 30.738-6.26 59.99-17.533 86.594l-42.343-34.72c-49.613 13.98-110.337 9.033-138.906-60.874l-41.97 152.938c-8.837-45.53-23.35-81.28-47.905-115.22-19.71 13.855-32.352 32.63-39.72 50.97L88.94 237.03c-17.85 27.32-33.77 56.565-45.032 90.47-7.744-22.6-11.968-46.852-11.968-72.094 0-26.013 4.484-50.973 12.687-74.156 2.752 6.608 9.27 11.25 16.875 11.25 10.093 0 18.28-8.157 18.28-18.25s-8.187-18.28-18.28-18.28c-2.385 0-4.66.48-6.75 1.31 27.537-55.83 77.83-98.368 138.844-115.5a21.977 21.977 0 0 0-.844 6.095c0 12.146 9.823 22 21.97 22 12.144 0 22-9.854 22-22 0-4.99-1.67-9.59-4.47-13.28 7.092-.683 14.29-1.064 21.563-1.064zm18.75 27.657a11.65 11.65 0 0 0-11.657 11.657c0 6.443 5.213 11.687 11.656 11.687 6.444 0 11.688-5.243 11.688-11.686 0-6.444-5.244-11.656-11.688-11.656zM198.03 90.22c-6.02.06-12.132.868-18.218 2.5-38.945 10.434-62.06 50.46-51.625 89.405 10.436 38.946 50.463 62.06 89.407 51.625 21.712-5.818 38.48-20.85 47.28-39.75a54.993 54.993 0 0 1-26.155 15.75c-29.504 7.905-59.846-9.59-67.75-39.094-7.907-29.504 9.62-59.813 39.124-67.72 10.41-2.788 20.906-2.417 30.5.533-12.28-8.598-27.116-13.405-42.563-13.25zm155.282.81c-9.408 0-17.03 7.624-17.03 17.032 0 9.41 7.622 17.032 17.03 17.032 9.41 0 17.032-7.623 17.032-17.03 0-9.41-7.623-17.033-17.03-17.033zm-248.937 27.376c-6.443 0-11.656 5.244-11.656 11.688 0 6.443 5.212 11.656 11.655 11.656s11.656-5.213 11.656-11.656c0-6.444-5.212-11.688-11.655-11.688zm275.688 40.813-.625 29.843-28.22 9.812 28.22 9.813.625 29.843 18.03-23.78 28.563 8.625-17.03-24.5 17.03-24.53L398.094 183l-18.03-23.78zm-72.094 11.593c-6.445 0-11.658 5.212-11.658 11.656 0 6.442 5.213 11.686 11.657 11.686 6.442 0 11.686-5.244 11.686-11.687 0-6.445-5.244-11.657-11.687-11.657zm139 74.75c-6.445 0-11.658 5.244-11.658 11.687s5.213 11.656 11.657 11.656c6.442 0 11.686-5.213 11.686-11.656 0-6.443-5.244-11.688-11.687-11.688zm-127.314 3.5c-6.443 0-11.656 5.244-11.656 11.687s5.213 11.656 11.656 11.656a11.648 11.648 0 0 0 11.656-11.656c0-6.443-5.212-11.688-11.656-11.688z" fill="#ffffff" fill-opacity="1" filter="url(#shadow-1)" stroke="#000000" stroke-opacity="1" stroke-width="1"></path></g>
        </svg>
        <div class="label" id="fullmoon-label">The Dark</div>

        <div class="panel" aria-hidden="true">
          <button class="close-x" aria-label="Close The Dark">✕</button>
          <div class="panel-title">The Dark</div>
          <img class="fade-image" alt="Full moon image" src=..\media\nightmoon.webp?q=80&w=1600&auto=format&fit=crop&ixlib=rb-4.0.3&s=6f9b5f6a2b3b1f0c1a3a6f2f8c7e8d9a>
          <div class="panel-body">
            <p><strong>LAYOUT</strong>: Arrange the area with night zones in mind: six spaces are needed for the NIGHT phase, typically nested within the outer ring of the DAY.</p>
            <p>Setup:</p>
            <ul>
              <li>Arrange six spaces for playing Bravery and Challenge cards (B and C cards).</li>
              <li>The first NIGHT card must be a Bravery (B) card.</li>            
              <li>The second NIGHT card must be a Challenge (C) card.</li>            
              <li>Alternate B and C cards until a total of six cards have been played.</li>            
              <li>Upon completing any card at NIGHT, move on to the next player.</li>
              <li>Upon the next player's turn, they may choose to flee the NIGHT and continue to DAWN, or to continue deeper into the NIGHT.</li>
            </ul>
            <p><em>Notes:</em> You may always appeal to the narrator during the night, especially when consulting your NPCs.</p>
          </div>
        </div>
      </article>

      <!-- The Deep -->
      <article class="sun" id="crescent" data-key="crescent" aria-labelledby="crescent-label">
        <!-- The Deep SVG -->
        <svg class="orb" width="180" height="180" viewBox="0 0 512 512" role="button" tabindex="0" aria-pressed="false" aria-label="Open The Deep">
          <defs><filter id="shadow-1" height="300%" width="300%" x="-100%" y="-100%"><feFlood flood-color="rgba(189, 16, 224, 1)" result="flood"></feFlood><feComposite in="flood" in2="SourceGraphic" operator="atop" result="composite"></feComposite><feGaussianBlur in="composite" stdDeviation="15" result="blur"></feGaussianBlur><feOffset dx="0" dy="0" result="offset"></feOffset><feComposite in="SourceGraphic" in2="offset" operator="over"></feComposite></filter><radialGradient id="lorc-evil-moon-gradient-0"><stop offset="0%" stop-color="#9013fe" stop-opacity="1"></stop><stop offset="100%" stop-color="#000000" stop-opacity="1"></stop></radialGradient></defs><circle cx="256" cy="256" r="251" fill="url(#lorc-evil-moon-gradient-0)" stroke="#bd10e0" stroke-opacity="1" stroke-width="5"></circle><g class="" transform="translate(0,0)" style=""><path d="M255.938 19.938C124.514 19.938 17.78 126.67 17.78 258.094c0 131.422 106.735 238.156 238.157 238.156 131.423 0 238.157-106.734 238.157-238.156 0-131.422-106.734-238.156-238.156-238.156zm0 18.687c121.322 0 219.468 98.147 219.468 219.47 0 26.08-4.548 51.085-12.875 74.28-20.99 8.188-43.686 12.75-67.624 12.75-22.242 0-43.584-3.855-63.406-10.938l12.094 44.594-71.75-12.467 18.844 51.562c-57.855 7.1-108.19-15.432-130.47-49.28l81.313 1.78-23.56-48.438 72.436-8.062.688.063c-16.83-11.135-31.777-24.876-44.22-40.688 30.674-18.014 66.44-28.814 102.782-22.844-43.234-49.45-95.713-64.09-139.437-57.437a187.763 187.763 0 0 1-3.345-35.314c0-45.286 16.2-86.562 42.938-118.937 2.04-.057 4.072-.095 6.125-.095zM139.188 180.78c.638-.006 1.268-.013 1.906 0 19.467.437 38.24 10.748 48.687 28.845 15.923 27.577 6.48 62.83-21.093 78.75-27.572 15.92-62.828 6.483-78.75-21.094-15.92-27.576-6.478-62.86 21.094-78.78a57.431 57.431 0 0 1 28.157-7.72zm-.063 21.064c-20.26 0-36.906 16.643-36.906 36.906 0 20.263 16.644 36.875 36.905 36.875 20.26 0 36.875-16.612 36.875-36.875s-16.614-36.906-36.875-36.906zm0 18.687c10.16 0 18.188 8.058 18.188 18.22 0 10.162-8.028 18.188-18.188 18.188-10.16 0-18.22-8.026-18.22-18.188 0-10.162 8.06-18.22 18.22-18.22z" fill="#ffffff" fill-opacity="1" transform="translate(0, 0) scale(1, 1) rotate(45, 256, 256) skewX(0) skewY(0)" filter="url(#shadow-1)"></path></g>
        </svg>
        <div class="label" id="crescent-label">The Deep</div>

        <div class="panel" aria-hidden="true">
          <button class="close-x" aria-label="Close The Deep">✕</button>
          <div class="panel-title">The Deep</div>
          <img class="fade-image" alt="Crescent moon image" src="..\media\night.webp?q=80&w=1600&auto=format&fit=crop&ixlib=rb-4.0.3&s=8a9e2a2b7b1f2d3f4c5b6c7d8e9a0b1c">
          <div class="panel-body">
            <p><strong>LONGPLAY</strong>: Regardless of entering the night, as the cycle increases at DAWN the night cycle count will also increase. This has various effects on continuing gameplay.</p>
            <p>Examples:</p>
            <ul>
              <li>Chances for creature encounters increase.</li>
              <li>The number and power of enemies increase.</li>
              <li>Negative fateful encounters occur more frequently.</li>
              <li>Weather and seasons become more extreme and foreboding.</li>
              <li>Night survival becomes more challenging.</li>
            </ul>
            <p><em>Note:</em> The narrator may add or negate such effects to their whim.</p>
          </div>
        </div>
      </article>

    </section>
    
    <!-- Bottom spacer to provide breathing room for the last entry -->
    <div style="height: 30px;"></div>
  </main>

  <script>
    // -------------------------
    // Core interactions
    // -------------------------
    (function(){
      const suns = Array.from(document.querySelectorAll('.sun'));
      const infoBtn = document.getElementById('openInfo');
      const infoPanel = document.getElementById('infoPanel');
      const closeInfo = document.getElementById('closeInfo');

      // Helpers
      function closeAllExcept(key){
        suns.forEach(s => {
          const k = s.dataset.key;
          if(k !== key){
            s.classList.remove('expanded');
            s.querySelector('.panel').setAttribute('aria-hidden','true');
            s.querySelector('.orb').setAttribute('aria-pressed','false');
            s.classList.add('dimmed');
          } else {
            s.classList.add('expanded');
            s.classList.remove('dimmed');
            s.querySelector('.panel').setAttribute('aria-hidden','false');
            s.querySelector('.orb').setAttribute('aria-pressed','true');
          }
        });

        // If same key is null => close all
        if(!key){
          suns.forEach(s=>{
            s.classList.remove('expanded','dimmed');
            s.querySelector('.panel').setAttribute('aria-hidden','true');
            s.querySelector('.orb').setAttribute('aria-pressed','false');
          });
        }
      }

      // Toggle logic: open clicked, dim others and slide them down (CSS handles translation via .dimmed)
      suns.forEach(sun => {
        const orb = sun.querySelector('.orb');
        const panel = sun.querySelector('.panel');
        const close = sun.querySelector('.close-x');

        function expand(){
          const isExpanded = sun.classList.contains('expanded');
          if(isExpanded){
            // collapse
            sun.classList.remove('expanded');
            panel.setAttribute('aria-hidden','true');
            orb.setAttribute('aria-pressed','false');
            // restore all
            suns.forEach(other=> other.classList.remove('dimmed'));
          } else {
            // expand this one
            closeAllExcept(sun.dataset.key);
            // scroll into view smoothly (center active)
            setTimeout(()=> {
              sun.scrollIntoView({behavior:'smooth', block:'center'});
            }, 60);
          }
        }

        orb.addEventListener('click', expand);
        orb.addEventListener('keydown', (ev) => {
          if(ev.key === 'Enter' || ev.key === ' '){
            ev.preventDefault();
            expand();
          }
        });

        close.addEventListener('click', (e) => {
          e.stopPropagation();
          sun.classList.remove('expanded');
          panel.setAttribute('aria-hidden','true');
          orb.setAttribute('aria-pressed','false');
          suns.forEach(other=> other.classList.remove('dimmed'));
        });
      });

      // Click outside: if click on background area, close all
      document.addEventListener('click', (e) => {
        const inMain = e.target.closest('.suns-row') || e.target.closest('.panel') || e.target.closest('.orb');
        const inInfo = e.target.closest('#infoPanel') || e.target.closest('#openInfo');
        if(!inMain && !inInfo){
          closeAllExcept(null);
        }
      });

      // Info panel toggle
      infoBtn.addEventListener('click', (e) => {
        const visible = infoPanel.style.display !== 'none';
        if(visible){
          infoPanel.style.display = 'none';
          infoBtn.setAttribute('aria-expanded','false');
          infoPanel.setAttribute('aria-hidden','true');
        } else {
          infoPanel.style.display = 'block';
          infoBtn.setAttribute('aria-expanded','true');
          infoPanel.setAttribute('aria-hidden','false');
        }
      });
      closeInfo.addEventListener('click', ()=> {
        infoPanel.style.display = 'none';
        infoBtn.setAttribute('aria-expanded','false');
        infoPanel.setAttribute('aria-hidden','true');
      });

      // keyboard: ESC closes expanded panels and info panel
      document.addEventListener('keydown', (ev) => {
        if(ev.key === 'Escape'){
          closeAllExcept(null);
          infoPanel.style.display = 'none';
          infoBtn.setAttribute('aria-expanded','false');
          infoPanel.setAttribute('aria-hidden','true');
        }
      });

      // Prevent pointer events for dimmed nodes after transition (cleanup)
      // (Optional) Add small delay to re-enable pointer events after expansion finished.
      // We rely on pointer-events:none applied via .dimmed (see CSS) so no further JS required.

    })();
  </script>
</body>
</html>