<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>The DAY — Redesigned</title>
  <style>
    /* -------------------------
       Base / Reset
       ------------------------- */
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family: "Georgia", serif;
      background: linear-gradient(135deg,#fff7e6 0%, #f8ecd6 40%, #e8f6fb 100%);
      color:#1e2a2b;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      overflow-y:auto;
    }
body {
  background: linear-gradient(135deg,#fff7e6 0%, #f8ecd6 40%, #e8f6fb 100%);
  background-repeat: no-repeat;   /* STOP repeating */
  background-attachment: fixed;   /* Stays in place while scrolling */
  background-size: cover;         /* Fills whole viewport */
}

    /* -------------------------
       Top fixed bar
       ------------------------- */
    .top-bar{
      position:fixed;
      top:0;
      left:0;
      width:100%;
      height:64px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:0 28px;
      gap:12px;
      z-index:1000;
      backdrop-filter: blur(6px) saturate(.9);
      background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.6));
      border-bottom:1px solid rgba(0,0,0,0.06);
      box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    }

    .bar-left, .bar-center, .bar-right { display:flex; align-items:center; gap:12px; }

    /* Return button */
    .return-btn{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 16px;
      border-radius:8px;
      cursor:pointer;
      text-decoration:none;
      font-weight:700;
      background:#ffffff;
      color:#000000;
      border:2px solid rgba(0,0,0,0.08);
      transition: background .22s ease, color .22s ease, transform .12s ease;
    }
    .return-btn:hover,
    .return-btn:focus{
      background:#d92727; /* red */
      color:#fff;
      outline:none;
      transform:translateY(-1px);
      box-shadow:0 8px 20px rgba(217,39,39,0.12);
    }

    /* Title */
    .title {
      font-size:20px;
      letter-spacing:2px;
      font-weight:800;
      text-align:center;
      color:#3a2b10;
      text-transform:uppercase;
      padding:6px 12px;
      position:relative;
    }
    .title::after{
      content:"";
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      bottom:-8px;
      width:60px;
      height:6px;
      border-radius:6px;
      background:linear-gradient(90deg,#ffd700,#ffb347);
      filter:drop-shadow(0 6px 16px rgba(255,180,0,0.12));
      opacity:.85;
    }

    /* Info (?) button */
    .info-btn{
      width:44px;height:44px;border-radius:10px;border:none;
      background:transparent;cursor:pointer;font-weight:700;
      display:inline-grid;place-items:center;font-size:18px;
      transition:transform .12s ease, background .12s ease;
    }
    .info-btn:hover{ transform:translateY(-1px); background: rgba(0,0,0,0.03); }

    /* -------------------------
       Main layout (Widescreen >=800px)
       ------------------------- */
    .page-inner{
      max-width:1200px;
      margin: 96px auto 80px; /* leave room for fixed bar */
      padding: 28px;
    }

    .suns-row{
      display:flex;
      gap:28px;
      align-items:flex-start;
      justify-content:space-between;
    }

    /* Sun capsule (default) and expanded panel */
    .sun {
      flex:1 1 0;
      min-width:260px;
      max-width:360px;
      display:flex;
      flex-direction:column;
      align-items:center;
      transition: transform .45s cubic-bezier(.2,.9,.28,1), opacity .35s ease;
      will-change: transform, opacity;
      position:relative;
    }

    /* The glowing ball */
    .sun .orb {
      width:180px;height:180px;border-radius:50%;
      background:
        radial-gradient(circle at 35% 25%, rgba(255,255,255,0.95) 0px, rgba(255,248,200,1) 8%,
                        rgba(255,200,60,0.9) 40%, rgba(255,150,0,0.6) 70%, transparent 100%),
        radial-gradient(circle at 60% 70%, rgba(255,255,255,0.1), transparent 60%);
      box-shadow: 0 10px 40px rgba(255,180,0,0.18), inset 0 -8px 30px rgba(255,220,120,0.12);
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      transition: transform .35s ease, box-shadow .35s ease, filter .35s ease;
      animation: floatOrb 4.5s ease-in-out infinite;
      user-select:none;
    }
    .orb:hover{ transform: scale(1.06); box-shadow: 0 14px 54px rgba(255,190,0,0.26); filter:brightness(1.04) saturate(1.03); }

    @keyframes floatOrb {
      0%{ transform: translateY(0) }
      50%{ transform: translateY(-8px) }
      100%{ transform: translateY(0) }
    }

    /* Orb label below */
    .sun .label {
      margin-top:18px;
      font-weight:800;
      text-transform:uppercase;
      letter-spacing:1px;
      color:#3a2b10;
      font-size:14px;
    }

    /* Expanded panel */
    .panel {
      position: relative;
      width: 100%;
      margin-top: 18px;
      border-radius: 14px;
      overflow: hidden;
      background: linear-gradient(180deg, rgba(255,255,255,0.96), rgba(255,250,240,0.98));
      box-shadow: 0 18px 40px rgba(20,30,40,0.06);
      transform-origin: top center;
      opacity: 0;
      max-height: 0;
      padding: 0 22px;
      border: 1px solid rgba(0,0,0,0.04);
      transition:
        opacity .4s ease,
        max-height .75s ease;   /* slowed for smoother expansion */
    }

    /* when expanded */
    .sun.expanded .panel {
      opacity: 1;
      max-height: 2000px;        /* HIGH VALUE to allow full text height */
      padding: 18px 22px 30px;
    }

    /* when expanded */
    .sun.expanded{
      transform:translateY(-2px) scale(1.02);
      z-index:30;
    }

    /* Close button (top-left inside panel) */
    .close-x{
      position:absolute;
      left:14px;
      top:14px;
      width:36px;height:36px;border-radius:8px;
      display:inline-grid;place-items:center;
      cursor:pointer;border:none;background:transparent;font-weight:700;
      transition: transform .12s ease;
    }
    .close-x:hover{ transform:translateY(-2px); background: rgba(0,0,0,0.04); }

    /* Panel title */
    .panel .panel-title{
      text-transform:uppercase;
      font-weight:900;
      letter-spacing:1.5px;
      font-size:18px;
      margin-left:58px; /* leave space for close button */
      margin-bottom:12px;
      color:#3a2b10;
    }

    /* Image with faded/dissolved top border */
    .panel .fade-image{
      width:100%;
      height:220px;
      border-radius:10px;
      object-fit:cover;
      display:block;
        mask-image: radial-gradient(circle, 
            rgba(0,0,0,1) 40%, 
            rgba(0,0,0,0.5) 70%, 
            rgba(0,0,0,0) 100%
        );
        -webkit-mask-image: radial-gradient(circle, 
            rgba(0,0,0,1) 40%, 
            rgba(0,0,0,0.5) 70%, 
            rgba(0,0,0,0) 100%
        );
      box-shadow: inset 0 30px 60px rgba(0,0,0,0.03);
      margin-bottom:14px;
      background:linear-gradient(180deg,#f7f1e0,#efe2c9);
    }

    /* Text area */
    .panel .panel-body {
      font-size:15px;
      line-height:1.6;
      color:#21302f;
    }
    .panel .panel-body p{ margin-bottom:12px }
    .panel .panel-body ul{ margin-left:18px; margin-bottom:12px }
    .panel .panel-body li{ margin-bottom:6px }

    /* When another orb is expanded, all others fully fade & slide down */
    .sun.dimmed{
      opacity: 0;                 /* fully invisible */
      transform: translateY(60px) scale(.94);
      pointer-events: none;
      filter: blur(4px);          /* optional atmospheric blur */
      transition:
        opacity .45s ease,
        transform .55s cubic-bezier(.2,.9,.28,1),
        filter .35s ease;
    }
    /* -------------------------
       Small screens fallback
       ------------------------- */
    @media (max-width: 799px) {
      .page-inner{ margin:84px 18px 48px }
      .suns-row{flex-direction:column; gap:18px}
      .sun{max-width:100%}
      .orb{ width:140px;height:140px }
      .panel .fade-image{ height:160px }
    }

    .sun.dimmed .orb{
      filter: brightness(1.4) blur(10px);
    }
/*    .top-bar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 64px;
      display: flex;
      align-items: center;
      justify-content: space-between; // keep left/right in place 
      padding: 0 28px;
      gap: 12px;
      z-index: 1000;
      backdrop-filter: blur(6px) saturate(.9);
      background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.6));
      border-bottom: 1px solid rgba(0,0,0,0.06);
      box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    }*/

    /* PERFECT CENTERING FIX */
    .bar-center {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }

  </style>
</head>
<body>

  <!-- Top bar -->
  <header class="top-bar" role="banner" aria-label="Top navigation">
    <div class="bar-left">
      <a href="../dreamer.html" class="return-btn" title="Return To Dreaming…">← Return To Dreaming…</a>
    </div>

    <div class="bar-center">
      <div class="title" aria-hidden="true">THE DAY</div>
    </div>

    <div class="bar-right">
      <button class="info-btn" id="openInfo" aria-expanded="false" aria-controls="infoPanel" title="More information">?</button>
    </div>
  </header>

  <!-- Supplemental info modal/panel -->
  <div id="infoPanel" role="dialog" aria-modal="true" aria-hidden="true"
       style="position:fixed; right:22px; top:80px; width:360px; max-width:calc(100% - 48px); z-index:1200;
              border-radius:12px; background:linear-gradient(180deg,#fff,#fffaf0); padding:18px; box-shadow:0 20px 60px rgba(20,30,40,0.12); border:1px solid rgba(0,0,0,0.06); display:none;">
    <button id="closeInfo" style="position:absolute; right:10px; top:10px; border:none; background:transparent; cursor:pointer; font-weight:700;">✕</button>
    <h3 style="margin-bottom:8px; font-size:16px; text-transform:uppercase; letter-spacing:1px;">About The Day</h3>
    <p style="font-size:14px; line-height:1.5; color:#223231;">
      This panel holds supplemental context and worldbuilding for "The Day".
      Click any sun to expand its chapter. When one expands, the others fade and slide down to emphasise the active chapter.
    </p>
  </div>

  <!-- Main area -->
  <main class="page-inner" id="main" role="main">
    <section class="suns-row" aria-label="Chapters of the day">

      <!-- THE DAWN -->
      <article class="sun" id="dawn" data-key="dawn" aria-labelledby="dawn-label">
        <div class="orb" role="button" tabindex="0" aria-pressed="false" aria-label="Open The Dawn">
          <!-- optional decorative inner svg -->
          <svg width="80" height="80" viewBox="0 0 100 100" aria-hidden="true">
            <defs>
              <linearGradient id="g1" x1="0" x2="1"><stop offset="0" stop-color="#fff"/><stop offset="1" stop-color="#ffd27a"/></linearGradient>
            </defs>
            <circle cx="50" cy="50" r="28" fill="url(#g1)" opacity="0.95"></circle>
          </svg>
        </div>
        <div class="label" id="dawn-label">The Dawn</div>

        <div class="panel" aria-hidden="true">
          <button class="close-x" aria-label="Close The Dawn">✕</button>
          <div class="panel-title">The Dawn</div>
          <!-- image: replace src with your own; masked to fade near top -->
          <img class="fade-image" alt="Dawn image" src="..\media\dawn1.webp?q=80&w=1600&auto=format&fit=crop&ixlib=rb-4.0.3&s=5f6b4a6c6f79c2b2f9d2c79e2d5d9b0d">
          <div class="panel-body">
            <p><strong>DAWNLIGHT</strong>: All days begin with dawn. Dawnlight is the most potent form of light, so be sure to soak it all in!</p>
            <p>Gaining power at dawn:</p>
            <ul>
              <li>All players regain all light mana.</li>
              <li>All players gain one level.</li>
              <li>Some effects and cards are now reset.</li>
            </ul>
            <p><em>Notes:</em> Dawnlight may be obscurred or diminished by weather and seasons.</p>
          </div>
        </div>
      </article>

      <!-- THE WHEEL -->
      <article class="sun" id="wheel" data-key="wheel" aria-labelledby="wheel-label">
        <div class="orb" role="button" tabindex="0" aria-pressed="false" aria-label="Open The Wheel">
          <svg width="80" height="80" viewBox="0 0 100 100" aria-hidden="true">
            <defs><linearGradient id="g2"><stop offset="0" stop-color="#fff"/><stop offset="1" stop-color="#ffd580"/></linearGradient></defs>
            <circle cx="50" cy="50" r="26" fill="url(#g2)" opacity="0.98"></circle>
          </svg>
        </div>
        <div class="label" id="wheel-label">The Wheel</div>

        <div class="panel" aria-hidden="true">
          <button class="close-x" aria-label="Close The Wheel">✕</button>
          <div class="panel-title">The Wheel</div>
          <img class="fade-image" alt="Wheel image" src=..\media\cycler.webp?q=80&w=1600&auto=format&fit=crop&ixlib=rb-4.0.3&s=6f9b5f6a2b3b1f0c1a3a6f2f8c7e8d9a>
          <div class="panel-body">
            <p><strong>LAYOUT</strong>: Arrange the area with two zones in mind: the day and the night. Imagine a clockface: the day consists of twelve zones; 12 o'clock is labeled the DAWN and is not considered a playable zone. Meanwhile, the night consists of only six zones; usually, the night is nested inside the play area, whereas the day acts as an outer ring play area.</p>
            <p>Setup:</p>
            <ul>
              <li>Arrange twelve spaces for playing Adventure, Bravery, and Challenge cards (A, B, C cards).</li>
              <li>12 o'clock is reserved as "DAWN".</li>
              <li>Begin at DAWN, then decide who will go first on the space immediately after DAWN.</li>
              <li>The final space prior to DAWN is known as DUSK.</li>
              <li>After one player concludes DUSK, the next player decides to proceed to DAWN or to enter the NIGHT phase. Proceeding to dawn, players will resolve effects for DAWN and this same player will then begin on the space immediately after DAWN. Entering the NIGHT, this player will begin the first space of the NIGHT phase.</li>
              <li>Each space has randomized additional effects, bonuses, and requirements as players progress throughout the day.</li>
            </ul>
            <p><em>Notes:</em> In total, any <em>day</em> has <em>11</em> spaces, resulting players rotating both when and how many times they will be able to play in any given cycle.</p>
          </div>
        </div>
      </article>

      <!-- THE CYCLE -->
      <article class="sun" id="cycle" data-key="cycle" aria-labelledby="cycle-label">
        <div class="orb" role="button" tabindex="0" aria-pressed="false" aria-label="Open The Cycle">
          <svg width="80" height="80" viewBox="0 0 100 100" aria-hidden="true">
            <defs><linearGradient id="g3"><stop offset="0" stop-color="#fff"/><stop offset="1" stop-color="#ffc36b"/></linearGradient></defs>
            <circle cx="50" cy="50" r="24" fill="url(#g3)" opacity="0.98"></circle>
          </svg>
        </div>
        <div class="label" id="cycle-label">The Cycle</div>

        <div class="panel" aria-hidden="true">
          <button class="close-x" aria-label="Close The Cycle">✕</button>
          <div class="panel-title">The Cycle</div>
          <img class="fade-image" alt="Cycle image" src="..\media\dusk1.webp?q=80&w=1600&auto=format&fit=crop&ixlib=rb-4.0.3&s=8a9e2a2b7b1f2d3f4c5b6c7d8e9a0b1c">
          <div class="panel-body">
            <p><strong>LONGPLAY</strong>: Upon continuing to DAWN via DUSK or NIGHT, the cycle count will increase. This has various effects on continuing gameplay.</p>
            <p>Examples:</p>
            <ul>
              <li>DAWN may no longer completely refill mana.</li>
              <li>Chances for enemy encounter increase.</li>
              <li>The number and strength of enemies increase.</li>
              <li>Terrible fateful encounters occur more frequently.</li>
              <li>Weather and seasons become more extreme.</li>
              <li>Daily survival becomes more difficult.</li>
            </ul>
            <p><em>Note:</em> The narrator may add or negate such effects to their whim.</p>
          </div>
        </div>
      </article>

    </section>
  </main>

  <script>
    // -------------------------
    // Core interactions
    // -------------------------
    (function(){
      const suns = Array.from(document.querySelectorAll('.sun'));
      const infoBtn = document.getElementById('openInfo');
      const infoPanel = document.getElementById('infoPanel');
      const closeInfo = document.getElementById('closeInfo');

      // Helpers
      function closeAllExcept(key){
        suns.forEach(s => {
          const k = s.dataset.key;
          if(k !== key){
            s.classList.remove('expanded');
            s.querySelector('.panel').setAttribute('aria-hidden','true');
            s.querySelector('.orb').setAttribute('aria-pressed','false');
            s.classList.add('dimmed');
          } else {
            s.classList.add('expanded');
            s.classList.remove('dimmed');
            s.querySelector('.panel').setAttribute('aria-hidden','false');
            s.querySelector('.orb').setAttribute('aria-pressed','true');
          }
        });

        // If same key is null => close all
        if(!key){
          suns.forEach(s=>{
            s.classList.remove('expanded','dimmed');
            s.querySelector('.panel').setAttribute('aria-hidden','true');
            s.querySelector('.orb').setAttribute('aria-pressed','false');
          });
        }
      }

      // Toggle logic: open clicked, dim others and slide them down (CSS handles translation via .dimmed)
      suns.forEach(sun => {
        const orb = sun.querySelector('.orb');
        const panel = sun.querySelector('.panel');
        const close = sun.querySelector('.close-x');

        function expand(){
          const isExpanded = sun.classList.contains('expanded');
          if(isExpanded){
            // collapse
            sun.classList.remove('expanded');
            panel.setAttribute('aria-hidden','true');
            orb.setAttribute('aria-pressed','false');
            // restore all
            suns.forEach(other=> other.classList.remove('dimmed'));
          } else {
            // expand this one
            closeAllExcept(sun.dataset.key);
            // scroll into view smoothly (center active)
            setTimeout(()=> {
              sun.scrollIntoView({behavior:'smooth', block:'center'});
            }, 60);
          }
        }

        orb.addEventListener('click', expand);
        orb.addEventListener('keydown', (ev) => {
          if(ev.key === 'Enter' || ev.key === ' '){
            ev.preventDefault();
            expand();
          }
        });

        close.addEventListener('click', (e) => {
          e.stopPropagation();
          sun.classList.remove('expanded');
          panel.setAttribute('aria-hidden','true');
          orb.setAttribute('aria-pressed','false');
          suns.forEach(other=> other.classList.remove('dimmed'));
        });
      });

      // Click outside: if click on background area, close all
      document.addEventListener('click', (e) => {
        const inMain = e.target.closest('.suns-row') || e.target.closest('.panel') || e.target.closest('.orb');
        const inInfo = e.target.closest('#infoPanel') || e.target.closest('#openInfo');
        if(!inMain && !inInfo){
          closeAllExcept(null);
        }
      });

      // Info panel toggle
      infoBtn.addEventListener('click', (e) => {
        const visible = infoPanel.style.display !== 'none';
        if(visible){
          infoPanel.style.display = 'none';
          infoBtn.setAttribute('aria-expanded','false');
          infoPanel.setAttribute('aria-hidden','true');
        } else {
          infoPanel.style.display = 'block';
          infoBtn.setAttribute('aria-expanded','true');
          infoPanel.setAttribute('aria-hidden','false');
        }
      });
      closeInfo.addEventListener('click', ()=> {
        infoPanel.style.display = 'none';
        infoBtn.setAttribute('aria-expanded','false');
        infoPanel.setAttribute('aria-hidden','true');
      });

      // keyboard: ESC closes expanded panels and info panel
      document.addEventListener('keydown', (ev) => {
        if(ev.key === 'Escape'){
          closeAllExcept(null);
          infoPanel.style.display = 'none';
          infoBtn.setAttribute('aria-expanded','false');
          infoPanel.setAttribute('aria-hidden','true');
        }
      });

      // Prevent pointer events for dimmed nodes after transition (cleanup)
      // (Optional) Add small delay to re-enable pointer events after expansion finished.
      // We rely on pointer-events:none applied via .dimmed (see CSS) so no further JS required.

    })();
  </script>
</body>
</html>
