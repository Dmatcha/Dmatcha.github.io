<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>The DAY — Redesigned</title>
  <style>
    /* -------------------------
       Base / Reset
       ------------------------- */
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family: "Georgia", serif;
      background: linear-gradient(135deg,#fff7e6 0%, #f8ecd6 40%, #e8f6fb 100%);
      color:#1e2a2b;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      overflow-y:auto;
    }
body {
  background: linear-gradient(135deg,#fff7e6 0%, #f8ecd6 40%, #e8f6fb 100%);
  background-repeat: no-repeat;   /* STOP repeating */
  background-attachment: fixed;   /* Stays in place while scrolling */
  background-size: cover;         /* Fills whole viewport */
}

    /* -------------------------
       Top fixed bar
       ------------------------- */
    .top-bar{
      position:fixed;
      top:0;
      left:0;
      width:100%;
      height:64px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:0 28px;
      gap:12px;
      z-index:1000;
      backdrop-filter: blur(6px) saturate(.9);
      background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.6));
      border-bottom:1px solid rgba(0,0,0,0.06);
      box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    }

    .bar-left, .bar-right { display:none; }
    .bar-center { display:flex; }
    
    /* Desktop top row layout */
    .top-row { 
      display: flex;
      align-items: center;
      gap: 12px;
      width: 100%;
      justify-content: space-between;
    }

    /* Return button */
    .return-btn{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 16px;
      border-radius:8px;
      cursor:pointer;
      text-decoration:none;
      font-weight:700;
      background:#ffffff;
      color:#000000;
      border:2px solid rgba(0,0,0,0.08);
      transition: background .22s ease, color .22s ease, transform .12s ease;
    }
    .return-btn:hover,
    .return-btn:focus{
      background:#d92727; /* red */
      color:#fff;
      outline:none;
      transform:translateY(-1px);
      box-shadow:0 8px 20px rgba(217,39,39,0.12);
    }

    /* Title */
    .title {
      font-size:20px;
      letter-spacing:2px;
      font-weight:800;
      text-align:center;
      color:#3a2b10;
      text-transform:uppercase;
      padding:6px 12px;
      position:relative;
    }
    .title::after{
      content:"";
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      bottom:-8px;
      width:60px;
      height:6px;
      border-radius:6px;
      background:linear-gradient(90deg,#ffd700,#ffb347);
      filter:drop-shadow(0 6px 16px rgba(255,180,0,0.12));
      opacity:.85;
    }

    /* Info (?) button */
    .info-btn{
      width:44px;height:44px;border-radius:10px;border:none;
      background:transparent;cursor:pointer;font-weight:700;
      display:inline-grid;place-items:center;font-size:18px;
      transition:transform .12s ease, background .12s ease;
    }
    .info-btn:hover{ transform:translateY(-1px); background: rgba(0,0,0,0.03); }

    /* -------------------------
       Main layout (Widescreen >=800px)
       ------------------------- */
    .page-inner{
      max-width:1200px;
      margin: 96px auto 80px; /* leave room for fixed bar */
      padding: 28px;
    }

    .suns-row{
      display:flex;
      gap:28px;
      align-items:flex-start;
      justify-content:space-between;
    }

    /* Sun capsule (default) and expanded panel */
    .sun {
      flex:1 1 0;
      min-width:260px;
      max-width:360px;
      display:flex;
      flex-direction:column;
      align-items:center;
      transition: transform .45s cubic-bezier(.2,.9,.28,1), opacity .35s ease;
      will-change: transform, opacity;
      position:relative;
    }

    /* The glowing ball - now SVG-based */
    .sun .orb {
      width:180px;height:180px;border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      transition: transform .35s ease, box-shadow .35s ease, filter .35s ease;
      animation: floatOrb 4.5s ease-in-out infinite;
      user-select:none;
    }
    .sun .orb:hover{ transform: scale(1.06); }
    .sun .orb svg { transition: transform .35s ease, filter .35s ease; }
    .sun .orb:hover svg{ filter:brightness(1.04) saturate(1.03); }

    @keyframes floatOrb {
      0%{ transform: translateY(0) }
      50%{ transform: translateY(-8px) }
      100%{ transform: translateY(0) }
    }

    /* Orb label below */
    .sun .label {
      margin-top:18px;
      font-weight:800;
      text-transform:uppercase;
      letter-spacing:1px;
      color:#3a2b10;
      font-size:14px;
    }

    /* Expanded panel */
    .panel {
      position: relative;
      width: 100%;
      margin-top: 18px;
      border-radius: 14px;
      overflow: hidden;
      background: linear-gradient(180deg, rgba(255,255,255,0.96), rgba(255,250,240,0.98));
      box-shadow: 0 18px 40px rgba(20,30,40,0.06);
      transform-origin: top center;
      opacity: 0;
      max-height: 0;
      padding: 0 22px;
      border: 1px solid rgba(0,0,0,0.04);
      transition:
        opacity .4s ease,
        max-height .75s ease;   /* slowed for smoother expansion */
    }

    /* when expanded */
    .sun.expanded .panel {
      opacity: 1;
      max-height: 2000px;        /* HIGH VALUE to allow full text height */
      padding: 18px 22px 30px;
    }

    /* when expanded */
    .sun.expanded{
      transform:translateY(-2px) scale(1.02);
      z-index:30;
    }

    /* Close button (top-left inside panel) */
    .close-x{
      position:absolute;
      left:14px;
      top:14px;
      width:36px;height:36px;border-radius:8px;
      display:inline-grid;place-items:center;
      cursor:pointer;border:none;background:transparent;font-weight:700;
      transition: transform .12s ease;
    }
    .close-x:hover{ transform:translateY(-2px); background: rgba(0,0,0,0.04); }

    /* Panel title */
    .panel .panel-title{
      text-transform:uppercase;
      font-weight:900;
      letter-spacing:1.5px;
      font-size:18px;
      margin-left:58px; /* leave space for close button */
      margin-bottom:12px;
      color:#3a2b10;
    }

    /* Image with faded/dissolved top border */
    .panel .fade-image{
      width:100%;
      height:220px;
      border-radius:10px;
      object-fit:cover;
      display:block;
        mask-image: radial-gradient(circle, 
            rgba(0,0,0,1) 40%, 
            rgba(0,0,0,0.5) 70%, 
            rgba(0,0,0,0) 100%
        );
        -webkit-mask-image: radial-gradient(circle, 
            rgba(0,0,0,1) 40%, 
            rgba(0,0,0,0.5) 70%, 
            rgba(0,0,0,0) 100%
        );
      box-shadow: inset 0 30px 60px rgba(0,0,0,0.03);
      margin-bottom:14px;
      background:linear-gradient(180deg,#f7f1e0,#efe2c9);
    }

    /* Text area */
    .panel .panel-body {
      font-size:15px;
      line-height:1.6;
      color:#21302f;
    }
    .panel .panel-body p{ margin-bottom:12px }
    .panel .panel-body ul{ margin-left:18px; margin-bottom:12px }
    .panel .panel-body li{ margin-bottom:6px }

    /* When another orb is expanded, all others fully fade & slide down */
    .sun.dimmed{
      opacity: 0;                 /* fully invisible */
      transform: translateY(60px) scale(.94);
      pointer-events: none;
      filter: blur(4px);          /* optional atmospheric blur */
      transition:
        opacity .45s ease,
        transform .55s cubic-bezier(.2,.9,.28,1),
        filter .35s ease;
    }
    /* -------------------------
       Tablet and mobile screens
       ------------------------- */
    @media (max-width: 800px) {
      .page-inner{ margin:110px 12px 42px }
      .suns-row{flex-direction:column; gap:18px}
      .sun{max-width:100%}
      /*.sun .orb{ width:140px;height:140px; clip-path: polygon(50% 0%, 100% 80%, 0% 80%); }*/
      .panel .fade-image{ height:160px }
      
      /* Mobile top bar layout - stacked layout */
      .top-bar{
        height: auto;
        min-height: 96px;
        padding: 12px 18px;
        flex-direction: column;
        gap: 12px;
        align-items: stretch;
      }
      
      /* Hide desktop layout on mobile */
      .bar-left, .bar-center, .bar-right { display: none; }
      
      /* Show and style mobile top row */
      .top-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
      }
      
      /* Show and center title on mobile */
      .top-bar .bar-center {
        display: flex;
        position: static;
        transform: none;
        width: 100%;
        justify-content: center;
        margin: 0;
      }
      
      .title {
        font-size: 18px;
        letter-spacing: 1.5px;
        margin: 0;
      }
      
      /* Return button styling on mobile */
      .top-row .return-btn {
        padding: 8px 12px;
        font-size: 14px;
        margin: 0;
      }
      
      /* Info button styling on mobile */
      .top-row .info-btn {
        width: 40px;
        height: 40px;
        font-size: 16px;
        margin: 0;
      }
    }

    .sun.dimmed .orb{
      filter: brightness(1.4) blur(10px);
    }
/*    .top-bar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 64px;
      display: flex;
      align-items: center;
      justify-content: space-between; // keep left/right in place 
      padding: 0 28px;
      gap: 12px;
      z-index: 1000;
      backdrop-filter: blur(6px) saturate(.9);
      background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.6));
      border-bottom: 1px solid rgba(0,0,0,0.06);
      box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    }*/

    /* PERFECT CENTERING FIX */
    .bar-center {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }

  </style>
</head>
<body>

  <!-- Top bar -->
  <header class="top-bar" role="banner" aria-label="Top navigation">
    <div class="top-row">
      <a href="../dreamer.html" class="return-btn" title="Return To Dreaming…">← Return To Dreaming…</a>
      <button class="info-btn" id="openInfo" aria-expanded="false" aria-controls="infoPanel" title="More information">?</button>
    </div>

    <div class="bar-center">
      <div class="title" aria-hidden="true">THE DAY</div>
    </div>
  </header>

  <!-- Supplemental info modal/panel -->
  <div id="infoPanel" role="dialog" aria-modal="true" aria-hidden="true"
       style="position:fixed; right:22px; top:80px; width:360px; max-width:calc(100% - 48px); z-index:1200;
              border-radius:12px; background:linear-gradient(180deg,#fff,#fffaf0); padding:18px; box-shadow:0 20px 60px rgba(20,30,40,0.12); border:1px solid rgba(0,0,0,0.06); display:none;">
    <button id="closeInfo" style="position:absolute; right:10px; top:10px; border:none; background:transparent; cursor:pointer; font-weight:700;">✕</button>
    <h3 style="margin-bottom:8px; font-size:16px; text-transform:uppercase; letter-spacing:1px;">About The Day</h3>
    <p style="font-size:14px; line-height:1.5; color:#223231;">
      This panel holds supplemental context and worldbuilding for "The Day".
      Click any sun to expand its chapter. When one expands, the others fade and slide down to emphasise the active chapter.
    </p>
  </div>

  <!-- Main area -->
  <main class="page-inner" id="main" role="main">
    <section class="suns-row" aria-label="Chapters of the day">

      <!-- THE DAWN -->
      <article class="sun" id="dawn" data-key="dawn" aria-labelledby="dawn-label">
        <svg class="orb" width="180" height="180" viewBox="0 0 512 512" role="button" tabindex="0" aria-pressed="false" aria-label="Open The Dawn">
          <!-- Sunrise SVG -->
          <circle cx="256" cy="256" r="251" fill="#f5a623" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="5"></circle>
          <g class="" transform="translate(0,10)" style="">
            <path d="M259.375 16.25c-132.32 0-239.78 107.46-239.78 239.78s107.46 239.783 239.78 239.783 239.78-107.462 239.78-239.782-107.46-239.78-239.78-239.78zm33.5 20.406c26.563 4.015 51.57 12.708 74.156 25.25L308.907 209.03c-14.573-7.215-30.96-11.344-48.312-11.53l32.28-160.844zm-67.72.094 23.97 161.22c-17.2 1.56-33.28 6.986-47.313 15.436l-51-151a220.436 220.436 0 0 1 74.344-25.656zm193.25 64.5c17.683 18.164 32.28 39.32 42.94 62.688l-107.658 85.468a111.724 111.724 0 0 0-34.968-34.875l99.686-113.28zm-319.092 1.063L192.5 219.686a111.684 111.684 0 0 0-32.063 37.75L56.5 166c10.527-23.725 25.082-45.226 42.813-63.688zm378.75 115.906a223.777 223.777 0 0 1 3.218 37.81c0 11.49-.882 22.768-2.56 33.783l-107.876 16.062a111.18 111.18 0 0 0-12-47.375l119.22-40.28zM40.25 221.093l115.844 45.75a111.338 111.338 0 0 0-8.188 39l-107.844-16.03A224.206 224.206 0 0 1 37.5 256.03c0-11.89.954-23.554 2.75-34.936zm130.563 89.53h177.125L467 334.532c-31.674 83.843-112.62 143.376-207.625 143.376-95.018 0-175.968-59.548-207.625-143.406l119.063-23.875z" fill="#fff" fill-opacity="1" transform="translate(25.6, 25.6) scale(0.9, 0.9) rotate(0, 256, 256) skewX(0) skewY(0)"></path>
          </g>
        </svg>
        <div class="label" id="dawn-label">The Dawn</div>

        <div class="panel" aria-hidden="true">
          <button class="close-x" aria-label="Close The Dawn">✕</button>
          <div class="panel-title">The Dawn</div>
          <!-- image: replace src with your own; masked to fade near top -->
          <img class="fade-image" alt="Dawn image" src="..\media\dawn1.webp?q=80&w=1600&auto=format&fit=crop&ixlib=rb-4.0.3&s=5f6b4a6c6f79c2b2f9d2c79e2d5d9b0d">
          <div class="panel-body">
            <p><strong>DAWNLIGHT</strong>: All days begin with dawn. Dawnlight is the most potent form of light, so be sure to soak it all in!</p>
            <p>Gaining power at dawn:</p>
            <ul>
              <li>All players regain all light mana.</li>
              <li>All players gain one level.</li>
              <li>Some effects and cards are now reset.</li>
            </ul>
            <p><em>Notes:</em> Dawnlight may be obscurred or diminished by weather and seasons.</p>
          </div>
        </div>
      </article>

      <!-- THE WHEEL -->
      <article class="sun" id="wheel" data-key="wheel" aria-labelledby="wheel-label">
        <svg class="orb" width="180" height="180" viewBox="0 0 512 512" role="button" tabindex="0" aria-pressed="false" aria-label="Open The Wheel">
          <!-- Sundial SVG -->
          <defs>
            <filter id="shadow-1" height="300%" width="300%" x="-100%" y="-100%">
              <feFlood flood-color="rgba(255, 255, 255, 1)" result="flood"></feFlood>
              <feComposite in="flood" in2="SourceGraphic" operator="atop" result="composite"></feComposite>
              <feGaussianBlur in="composite" stdDeviation="15" result="blur"></feGaussianBlur>
              <feOffset dx="0" dy="0" result="offset"></feOffset>
              <feComposite in="SourceGraphic" in2="offset" operator="over"></feComposite>
            </filter>
            <radialGradient id="lorc-sundial-gradient-0">
              <stop offset="0%" stop-color="#f8e71c" stop-opacity="1"></stop>
              <stop offset="100%" stop-color="#f5a623" stop-opacity="1"></stop>
            </radialGradient>
          </defs>
          <circle cx="256" cy="256" r="256" fill="url(#lorc-sundial-gradient-0)"></circle>
          <g class="" transform="translate(0,0)" style="">
            <path d="m227.02 45.682-2.01 150.17a193.007 193.007 0 0 0-31.334 9.423l-34.46-54.44 10.48 65.913a195.292 195.292 0 0 0-31.362 22.043l-85.387-73.01 60.914 98.26a194.793 194.793 0 0 0-26.725 43.73l-37.89-9.674 32.146 24.228a193.34 193.34 0 0 0-10.036 46.89l-52.426 1.497 151.115 58.343c-5.937-13.1-9.244-27.634-9.244-42.922 0-57.535 46.842-104.378 104.378-104.378 57.535 0 104.377 46.843 104.377 104.38 0 14.662-3.05 28.628-8.535 41.304-.054.597-.1 1.188-.16 1.79l138.406-59.548-40.56-3.928a193.154 193.154 0 0 0-16.17-59.607l29.804-34.71-41.317 13.08a195.764 195.764 0 0 0-32.937-40.292l58.926-131.802-93.026 106.238a193.489 193.489 0 0 0-42.377-18.64l2.535-65.838-24.547 60.54a195.367 195.367 0 0 0-34.405-3.04c-2.4 0-4.785.06-7.164.146L227.02 45.682zm38.173 164.685c9.258 0 18.345.717 27.213 2.09l-19.693 48.572-10.74-50.622c1.072-.02 2.143-.04 3.22-.04zm-40.44 4.664-.515 38.53-20.392-32.218a174.6 174.6 0 0 1 20.908-6.31zm96.112 4.312a174.717 174.717 0 0 1 30.63 13.578l-32.585 37.213 1.955-50.79zm-148.03 17.15 5.85 36.803-26.048-22.274a176.35 176.35 0 0 1 20.197-14.528zm217.186 25.766a176.319 176.319 0 0 1 22.673 28.056l-41.02 12.987 18.348-41.042zm-265.73 18.605 26.808 43.24-45.643-11.654a175.599 175.599 0 0 1 18.836-31.587zM265.18 300.44c-47.435 0-85.69 38.256-85.69 85.69 0 47.436 38.255 85.688 85.69 85.688 47.435 0 85.687-38.252 85.687-85.687 0-47.434-38.252-85.69-85.687-85.69zm163.808 21.484a174.997 174.997 0 0 1 10.707 41.984l-43.17-4.18 32.463-37.804zM97.11 334.176l43.853 33.054-50.805 1.45a175.414 175.414 0 0 1 6.953-34.504z" fill="#ffc5af" fill-opacity="0.92" transform="translate(25.6, 25.6) scale(0.9, 0.9) rotate(0, 256, 256) skewX(0) skewY(0)" filter="url(#shadow-1)" stroke="#f5a623" stroke-opacity="1" stroke-width="5"></path>
          </g>
        </svg>
        <div class="label" id="wheel-label">The Wheel</div>

        <div class="panel" aria-hidden="true">
          <button class="close-x" aria-label="Close The Wheel">✕</button>
          <div class="panel-title">The Wheel</div>
          <img class="fade-image" alt="Wheel image" src=..\media\cycler.webp?q=80&w=1600&auto=format&fit=crop&ixlib=rb-4.0.3&s=6f9b5f6a2b3b1f0c1a3a6f2f8c7e8d9a>
          <div class="panel-body">
            <p><strong>LAYOUT</strong>: Arrange the area with two zones in mind: the day and the night. Imagine a clockface: the day consists of twelve zones; 12 o'clock is labeled the DAWN and is not considered a playable zone. Meanwhile, the night consists of only six zones; usually, the night is nested inside the play area, whereas the day acts as an outer ring play area.</p>
            <p>Setup:</p>
            <ul>
              <li>Arrange twelve spaces for playing Adventure, Bravery, and Challenge cards (A, B, C cards).</li>
              <li>12 o'clock is reserved as "DAWN".</li>
              <li>Begin at DAWN, then decide who will go first on the space immediately after DAWN.</li>
              <li>The final space prior to DAWN is known as DUSK: it must always be a "B" or "C" card.</li>
              <li>After one player concludes DUSK, the next player decides to proceed to DAWN or to enter the NIGHT phase. Proceeding to dawn, players will resolve effects for DAWN and this same player will then begin on the space immediately after DAWN. Entering the NIGHT, this player will begin the first space of the NIGHT phase.</li>
              <li>Each space has randomized additional effects, bonuses, and requirements as players progress throughout the day.</li>
            </ul>
            <p><em>Notes:</em> In total, any <em>day</em> has <em>11</em> spaces, resulting players rotating both when and how many times they will be able to play in any given cycle.</p>
          </div>
        </div>
      </article>

      <!-- THE CYCLE -->
      <article class="sun" id="cycle" data-key="cycle" aria-labelledby="cycle-label">
        <svg class="orb" width="180" height="180" viewBox="0 0 512 512" role="button" tabindex="0" aria-pressed="false" aria-label="Open The Cycle">
          <!-- Sun SVG -->
          <defs>
            <filter id="shadow-1" height="300%" width="300%" x="-100%" y="-100%">
              <feFlood flood-color="rgba(245, 166, 35, 1)" result="flood"></feFlood>
              <feComposite in="flood" in2="SourceGraphic" operator="atop" result="composite"></feComposite>
              <feGaussianBlur in="composite" stdDeviation="15" result="blur"></feGaussianBlur>
              <feOffset dx="0" dy="0" result="offset"></feOffset>
              <feComposite in="SourceGraphic" in2="offset" operator="over"></feComposite>
            </filter>
          </defs>
          <circle cx="256" cy="256" r="251" fill="#ffe0af" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="5"></circle>
          <g class="" transform="translate(0,0)" style="">
            <path d="M320.063 19.72c-72.258 14.575-19.248 71.693-74.344 108.81 4.846-.49 9.746-.702 14.655-.624 16.288.26 32.785 3.72 48.594 10.72a126.431 126.431 0 0 1 14.25 7.405c12.107-47.476-37.103-96.38-3.158-126.31zM136.75 44.47c-40.76 61.357 36.984 64.33 24.406 129.405 17.407-21.255 41.17-35.9 67.156-42.313-25.006-42.138-94.4-41.924-91.562-87.093zm297.313 75.405c-32.547.872-45.475 46.314-96.594 36.22 21.35 17.42 36.034 41.25 42.467 67.31 42.306-24.92 42.053-94.466 87.282-91.624-13.43-8.92-24.06-12.15-33.158-11.905zm-177.97 26.656c-23.656.46-46.53 8.82-64.906 23.626l18.657 36.156L170 193.156a107.628 107.628 0 0 0-9.406 16.938c-8.726 19.708-11.002 40.59-7.78 60.344l44.78 2.125-34 30.312c10.798 20.622 28.414 37.852 51.406 48.03a107.842 107.842 0 0 0 9.313 3.626l24.53-38.25 9.095 43.814c27.3.075 53.737-10.387 73.593-29.188l-19.186-37.125 38.406 12.658a108.49 108.49 0 0 0 5.03-9.938c9.746-22.01 11.457-45.498 6.44-67.22l-37.626-1.75 27.687-24.718c-10.83-20.194-28.236-37.07-50.874-47.093a107.405 107.405 0 0 0-4.125-1.72l-25.874 40.313-9.906-47.75c-.5-.016-1-.023-1.5-.032-1.3-.02-2.61-.024-3.906 0zM133.407 186.5c-41.652.725-82.483 34.847-108.72 5.094 14.573 72.234 71.664 19.3 108.783 74.312-2.154-20.972.934-42.758 10.06-63.375a126.36 126.36 0 0 1 7.345-14.093c-5.822-1.47-11.642-2.038-17.47-1.937zm249.5 53.97a124.649 124.649 0 0 1-10.03 63.624l-.188.375a126.38 126.38 0 0 1-7.22 13.78c47.524 12.244 96.507-37.137 126.47-3.156-14.603-72.388-71.92-19.04-109.032-74.625zM136.53 283.405c-42.123 25.014-41.928 94.37-87.093 91.53 61.422 40.803 64.322-37.123 129.594-24.342-21.344-17.385-36.03-41.167-42.5-67.188zm219.064 48.906c-17.406 21.46-41.236 36.24-67.344 42.72 24.944 42.263 94.497 42.004 91.656 87.218 40.867-61.52-37.402-64.358-24.312-129.938zM193.406 360.72c-12.047 47.456 37.087 96.33 3.156 126.25 72.305-14.587 19.195-71.79 74.47-108.908-21.04 2.204-42.898-.9-63.594-10.062a126.43 126.43 0 0 1-14.032-7.28z" fill="#f8e71c" fill-opacity="1" transform="translate(25.6, 25.6) scale(0.9, 0.9) rotate(15, 256, 256) skewX(0) skewY(0)" filter="url(#shadow-1)" stroke="#4a90e2" stroke-opacity="1" stroke-width="8"></path>
          </g>
        </svg>
        <div class="label" id="cycle-label">The Cycle</div>

        <div class="panel" aria-hidden="true">
          <button class="close-x" aria-label="Close The Cycle">✕</button>
          <div class="panel-title">The Cycle</div>
          <img class="fade-image" alt="Cycle image" src="..\media\dusk1.webp?q=80&w=1600&auto=format&fit=crop&ixlib=rb-4.0.3&s=8a9e2a2b7b1f2d3f4c5b6c7d8e9a0b1c">
          <div class="panel-body">
            <p><strong>LONGPLAY</strong>: Upon continuing to DAWN via DUSK or NIGHT, the cycle count will increase. This has various effects on continuing gameplay.</p>
            <p>Examples:</p>
            <ul>
              <li>DAWN may no longer completely refill mana.</li>
              <li>Chances for enemy encounter increase.</li>
              <li>The number and strength of enemies increase.</li>
              <li>Terrible fateful encounters occur more frequently.</li>
              <li>Weather and seasons become more extreme.</li>
              <li>Daily survival becomes more difficult.</li>
            </ul>
            <p><em>Note:</em> The narrator may add or negate such effects to their whim.</p>
          </div>
        </div>
      </article>

    </section>
    <div style="height: 30px;"></div>
  </main>

  <script>
    // -------------------------
    // Core interactions
    // -------------------------
    (function(){
      const suns = Array.from(document.querySelectorAll('.sun'));
      const infoBtn = document.getElementById('openInfo');
      const infoPanel = document.getElementById('infoPanel');
      const closeInfo = document.getElementById('closeInfo');

      // Helpers
      function closeAllExcept(key){
        suns.forEach(s => {
          const k = s.dataset.key;
          if(k !== key){
            s.classList.remove('expanded');
            s.querySelector('.panel').setAttribute('aria-hidden','true');
            s.querySelector('.orb').setAttribute('aria-pressed','false');
            s.classList.add('dimmed');
          } else {
            s.classList.add('expanded');
            s.classList.remove('dimmed');
            s.querySelector('.panel').setAttribute('aria-hidden','false');
            s.querySelector('.orb').setAttribute('aria-pressed','true');
          }
        });

        // If same key is null => close all
        if(!key){
          suns.forEach(s=>{
            s.classList.remove('expanded','dimmed');
            s.querySelector('.panel').setAttribute('aria-hidden','true');
            s.querySelector('.orb').setAttribute('aria-pressed','false');
          });
        }
      }

      // Toggle logic: open clicked, dim others and slide them down (CSS handles translation via .dimmed)
      suns.forEach(sun => {
        const orb = sun.querySelector('.orb');
        const panel = sun.querySelector('.panel');
        const close = sun.querySelector('.close-x');

        function expand(){
          const isExpanded = sun.classList.contains('expanded');
          if(isExpanded){
            // collapse
            sun.classList.remove('expanded');
            panel.setAttribute('aria-hidden','true');
            orb.setAttribute('aria-pressed','false');
            // restore all
            suns.forEach(other=> other.classList.remove('dimmed'));
          } else {
            // expand this one
            closeAllExcept(sun.dataset.key);
            // scroll into view smoothly (center active)
            setTimeout(()=> {
              sun.scrollIntoView({behavior:'smooth', block:'center'});
            }, 60);
          }
        }

        orb.addEventListener('click', expand);
        orb.addEventListener('keydown', (ev) => {
          if(ev.key === 'Enter' || ev.key === ' '){
            ev.preventDefault();
            expand();
          }
        });

        close.addEventListener('click', (e) => {
          e.stopPropagation();
          sun.classList.remove('expanded');
          panel.setAttribute('aria-hidden','true');
          orb.setAttribute('aria-pressed','false');
          suns.forEach(other=> other.classList.remove('dimmed'));
        });
      });

      // Click outside: if click on background area, close all
      document.addEventListener('click', (e) => {
        const inMain = e.target.closest('.suns-row') || e.target.closest('.panel') || e.target.closest('.orb');
        const inInfo = e.target.closest('#infoPanel') || e.target.closest('#openInfo');
        if(!inMain && !inInfo){
          closeAllExcept(null);
        }
      });

      // Info panel toggle
      infoBtn.addEventListener('click', (e) => {
        const visible = infoPanel.style.display !== 'none';
        if(visible){
          infoPanel.style.display = 'none';
          infoBtn.setAttribute('aria-expanded','false');
          infoPanel.setAttribute('aria-hidden','true');
        } else {
          infoPanel.style.display = 'block';
          infoBtn.setAttribute('aria-expanded','true');
          infoPanel.setAttribute('aria-hidden','false');
        }
      });
      closeInfo.addEventListener('click', ()=> {
        infoPanel.style.display = 'none';
        infoBtn.setAttribute('aria-expanded','false');
        infoPanel.setAttribute('aria-hidden','true');
      });

      // keyboard: ESC closes expanded panels and info panel
      document.addEventListener('keydown', (ev) => {
        if(ev.key === 'Escape'){
          closeAllExcept(null);
          infoPanel.style.display = 'none';
          infoBtn.setAttribute('aria-expanded','false');
          infoPanel.setAttribute('aria-hidden','true');
        }
      });

      // Prevent pointer events for dimmed nodes after transition (cleanup)
      // (Optional) Add small delay to re-enable pointer events after expansion finished.
      // We rely on pointer-events:none applied via .dimmed (see CSS) so no further JS required.

    })();
  </script>
</body>
</html>
