<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Friends - DEANSand</title>
  <style>
    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      min-height: 100%;
      background: #1a1a2e; /* Fallback if video doesn't load */
      font-family: Georgia, serif;
    }

    /* VIDEO BACKGROUND */
    .video-wrapper {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      z-index: 0;
      pointer-events: none;
    }

    .video-bg {
      position: absolute;
      top: 50%;
      left: 50%;
      min-width: 100%;
      min-height: 100%;
      width: auto;
      height: auto;
      transform: translate(-50%, -50%);
      object-fit: cover;
      filter: blur(2px) brightness(0.95) contrast(1.1);
      opacity: 0.99;
      pointer-events: none;
      transition: transform 0.3s ease;
    }

    /* Return button */
    .return-button {
      position: fixed;
      top: 20px;
      left: 20px;
      background: white;
      color: black;
      padding: 10px 18px;
      border-radius: 5px;
      text-decoration: none;
      z-index: 2000;
      transition: background 0.3s ease, color 0.3s ease;
    }

    .return-button:hover {
      background: red;
      color: white;
    }

    /* Ensure content is above video */
    .game-container,
    .result-wrapper {
      position: relative;
      z-index: 1;
    }

    /* ============================================
       GAME CONTAINER - Selection Phase
       ============================================ */
    .game-container {
      width: 100%;
      min-height: 100vh;
      padding-top: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .cards-row {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-evenly;
      padding: 2%;
    }

    /* Card slot - 30% width, aspect ratio preserved */
    .card-slot {
      width: 30%;
      aspect-ratio: 1218 / 1698;
      position: relative;
    }

    .card {
      width: 100%;
      height: 100%;
      cursor: pointer;
      perspective: 1200px;
      position: relative;
      transition: transform 0.3s ease;
    }

    .card:hover {
      transform: scale(1.03);
    }

    .card-inner {
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 0.6s ease;
      position: relative;
    }

    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    .card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 22px;
      box-shadow: 0 8px 21px rgba(240,100,20,0.35);
      overflow: hidden;
      background: #222;
    }

    .card-back {
      transform: rotateY(0deg);
    }

    .card-front {
      transform: rotateY(180deg);
      background: #fff;
    }

    .card-face img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    /* ============================================
       RESULT PHASE - Card + Floating Text
       ============================================ */
    .result-wrapper {
      display: none;
      width: 100%;
      min-height: 100vh;
      padding: 80px 2% 40px 2%;
    }

    .result-wrapper.active {
      display: flex;
      flex-wrap: wrap;
      align-items: flex-start;
      justify-content: center;
      gap: 3%;
    }

    /* Result card - 30% width, floats left */
    .result-card {
      width: 30%;
      aspect-ratio: 1218 / 1698;
      flex-shrink: 0;
    }

    .result-card .card {
      width: 100%;
      height: 100%;
      cursor: default;
    }

    /* Floating text card - floats right of the card */
    .floating-text-card {
      flex: 1;
      min-width: 300px;
      max-width: 55%;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.2);
      max-height: 80vh;
      overflow-y: auto;
    }

    .floating-text-card .char-name {
      font-size: clamp(24px, 3vw, 36px);
      color: #333;
      margin: 0 0 20px 0;
    }

    .floating-text-card .char-desc {
      font-size: clamp(15px, 1.6vw, 18px);
      line-height: 1.8;
      color: #444;
      margin: 0;
    }

    /* Fade out animation for non-selected cards */
    .fade-out {
      animation: fadeAway 0.4s ease forwards;
      pointer-events: none;
    }

    @keyframes fadeAway {
      from { opacity: 1; transform: scale(1); }
      to   { opacity: 0; transform: scale(0.7); }
    }

    /* Selected card - fixed position for animation */
    .card.selected {
      position: fixed !important;
      z-index: 1000;
      pointer-events: none;
      transition: left 0.8s cubic-bezier(0.22, 0.9, 0.34, 1),
                  top 0.8s cubic-bezier(0.22, 0.9, 0.34, 1),
                  width 0.6s ease,
                  height 0.6s ease;
    }
    /* ============================================
       VERTICAL MODE (< 700px)
       Cards height = 30% of viewport, stack vertically
       ============================================ */
    @media (max-width: 700px) {
      .game-container {
        align-items: flex-start;
        padding-top: 80px;
      }

      .cards-row {
        flex-direction: column;
        align-items: center;
        gap: 15px;
        padding: 3%;
      }

      /* In vertical mode: height = 30vh, width auto-calculated */
      .card-slot {
        width: auto;
        height: 30vh;
        aspect-ratio: 1218 / 1698;
      }

      /* Result wrapper stacks vertically */
      .result-wrapper.active {
        flex-direction: column;
        align-items: center;
        gap: 20px;
        padding: 80px 5% 40px 5%;
      }

      /* Result card - height limited to 40vh in vertical mode */
      .result-card {
        width: auto;
        height: 40vh;
        aspect-ratio: 1218 / 1698;
      }

      /* Text card goes below, full width, scrollable */
      .floating-text-card {
        width: 90%;
        max-width: none;
        min-width: auto;
        max-height: none;
        overflow-y: visible;
      }
    }
      @media (min-width: 901px) {  .card-face { border-radius: 36px;  }  }
  </style>
</head>
<body>
  <!-- VIDEO BACKGROUND -->
  <div class="video-wrapper">
    <video class="video-bg" autoplay muted loop playsinline>
      <source src="../media/138556-769988117_medium.mp4" type="video/mp4" />
      Your browser does not support the video tag.
    </video>
  </div>

  <a class="return-button" href="../dreamer.html">Return To Dreaming</a>

  <!-- SELECTION PHASE -->
  <div class="game-container" id="gameContainer">
    <div class="cards-row" id="cardsRow">
      <div class="card-slot">
        <div class="card" id="card1">
          <div class="card-inner">
            <div class="card-face card-back">
              <img id="back1" src="../P986/cards/backs/000_back.webp" alt="Card Back">
            </div>
            <div class="card-face card-front">
              <img id="front1" src="../P986/cards/fronts/000.webp" alt="Card Front">
            </div>
          </div>
        </div>
      </div>

      <div class="card-slot">
        <div class="card" id="card2">
          <div class="card-inner">
            <div class="card-face card-back">
              <img id="back2" src="../P986/cards/backs/000_back.webp" alt="Card Back">
            </div>
            <div class="card-face card-front">
              <img id="front2" src="../P986/cards/fronts/000.webp" alt="Card Front">
            </div>
          </div>
        </div>
      </div>

      <div class="card-slot">
        <div class="card" id="card3">
          <div class="card-inner">
            <div class="card-face card-back">
              <img id="back3" src="../P986/cards/backs/000_back.webp" alt="Card Back">
            </div>
            <div class="card-face card-front">
              <img id="front3" src="../P986/cards/fronts/000.webp" alt="Card Front">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- RESULT PHASE -->
  <div class="result-wrapper" id="resultWrapper">
    <div class="result-card" id="resultCard"></div>
    <div class="floating-text-card" id="floatingText">
      <h2 class="char-name" id="charName"></h2>
      <p class="char-desc" id="charDesc"></p>
    </div>
  </div>

  <script>
  const characterData = {
    "000": { 
    name: "Hitomi, The Aloof Sorceress", 
    description: `
    Knowledge of Jade Tech and Empire, soulgems and distilleries. Aware of far-off planes and future events. Penchant for lies and thievery. Her irreverence waxes and wanes with the moon. <em>Occasionally speaks and moves as if puppeted by an unseen master.</em> 
        <br><em><strong>Prefers whimsy; hates seriousness.</strong></em>
        <br><strong>Domains:</strong> Jade Tech, soulgems, distilleries, planes of existence.
        <br><strong>Backstory:</strong>
        Hitomi once served as a researcher in the Topazian capital’s Ministry of Distillation and Utilization, specializing in the early refinement of soulgems and their applications. She vanished after a disastrous experiment— failure during the crystallization compression phase, half-formed gems reverted immediately back to soulgas instead of souldust. The rapid expansion broke open the canisters, but instead of exploding, soulgas whirled around the room, moving as if it were alive. Some say she was briefly possessed by an entity from a place beyond, although the reports merely state she collapsed due to inhalation of soulgas. After her reappearance, she was found unfit to continue working, malaise coupled with knowledge that defies linear time. Now, she wanders towns and cities, always barely enough coin in hand, humming prophecy or madness.
        <br><strong>Motivations:</strong> Hitomi grapples with having glimpsed other worlds and lived other lives, returning her sanity would mean erasing the myriad of minds that coexist within her. Sometimes she acts and speaks as if some unseen master whispers through her. She hides this truth from everyone. For now, she simply wants somewhere to belong, somewhere she won’t be judged by her failures.
<br><strong>Fears:</strong> Losing autonomy to the presences inside her; confronting what her research lead to.
<br><strong>Affiliations:</strong>
Has a cautious professional respect for Lumiere, whose Topazian ties mirror her past.
Distrusts Hector Havel, who once tried to “recruit” her into his cult.
Secretly bests Tsubasa in strategy games, due to her omnisight.
<br><strong>Party Dynamics:</strong>
Will not join the party if Hector Havel is already present.
If Lumiere refuses to elaborate or withholds information, she will finish the thoughts.
May suddenly vanish from camp, reappearing and startling the party.
Always manages to steal enough coin from strangers for meals and inn rooms.
May mock Evelyn, Lumiere, Chinara, and Shang due to their seriousness.
          `},
    "001": { 
    name: "Tsubasa, The Tactician", 
    description: `Legendary warmaster and politician. Vast influence and top rank. Hesitant to share information. Master manipulator. <em>Something surprising lay behind those eyes... A laugh said to enchant all. </em><br><em><strong>Values thoughtfulness.</strong></em>
    <br><strong>Domains:</strong> Military strategy, politics, manipulation
<br><strong>Backstory:</strong>
Once hailed as the “Black Fox,” Tsubasa rose to prominence from a young age, hailing from a family of Jadian generals. After Jade fell, her family was offered employment by Topaz. Her father and mother were sworn to help seize lands for Topaz. After succeeding, her father was framed and executed, ensuring his prowess need never be used against them. Topazian royals were unaware that while the father was the face, her mother was the brains for each victory. Tsubasa knew to ensure her family’s continued survival aimed to become invaluable to the Topaz Kingdom, and set out to finalize the borders for the kingdoms. Eventually being promoted to a general, she ended the Border Wars through cunning rather than force. In truth, she had masterminded herself to command the frontline armies of the neighbouring lands, as one may play chess against oneself.
After losing faith in the monarchy she helped preserve, she turned to the shadows. She emerges to maintain appearances, keeping her family’s lives safe. Has she been merely morose, or have the shadows been busy weaving?
<br><strong>Motivations:</strong> To orchestrate a new order—one where information and democracy matter more than birthright. She recruits promising adventurers as pieces in her vast game of politics. Only she knows the end-game.
<br><strong>Fears:</strong> Being forgotten, or worse, her family’s legacy erased.
<br><strong>Affiliations:</strong>
Old flame of Jon Quixote; their parting was mutual but painful.
Respects Chinara Ekine, though their political ideals diverge.
Feigns pleasantries with Hitomi, yearns to defeat her in strategy games. Always loses.
<br><strong>Party Dynamics:</strong>
Refuses to join if Million Redgate is present, thinking Million alien enough to undermine her efforts.
May secretly garner fund the party if Flare vey Byornn is present.
Unlocks unique “strategic” dialogue options in conflicts.
    ` 
            },
    "002": { 
    name: "Tress Bien, The Hotheaded Mage", 
    description: `Freedom fighter. Expert in keys and traps. Collector of trinkets and jewellery. Sacrifice 'quick' or 'favour' for expert, stealthy thievery. <em>...And what does she do? Her best. </em><br><em><strong>Boastful; egotistical; vain.</strong></em>
    <br><strong>Domains:</strong> Keys, traps, rebellion, chaos
<br><strong>Backstory:</strong>
Tress grew up in the sewers beneath Top. Surviving through theft and trickery, her Sapphirean father figure spoke openly of the south sea and the old Sapphire cities. Her talent for explosive magic was discovered by accident when she blew open a magistrate’s vault. She was briefly captured, before being broken free and escaping to the south coast. There, she built a name for herself, although she never truly overcame her fear of the sea, ever since her first encounter with a vostrodile. 
<br><strong>Motivations:</strong> Freedom above all. Tress wants to dismantle the systems that enslaved her found family and scattered her companions. Her trinket collection is both sentimental and practical—each one holds a story of something she’s stolen back, along with hidden uses. She’s obsessed with salvaged Jade-tech employed by Sapphire, known as trick-weapons. She wants to destroy Top’s seafaring abilities, and colonize the cursed Jade fields so Sapphire can feed their people.
<br><strong>Fears:</strong> Cages, confinement, and commitment.
<br><strong>Affiliations:</strong>
Is easily swayed by Million Redgate’s cause; betrayed them accidentally by exposing a hideout.
Friendly rival with Marco; they often compete to pickpocket the same nobles.
Protectively fond of Naya, treating her like a younger sibling.
<br><strong>Party Dynamics:</strong>
Becomes erratic if Million Redgate joins the group, obeying Million instead of players.
Gains synergy with Marco in infiltration missions, raising success rate to maximum.
May attempt to rob Hector Havel in camp, causing a chain event.
Chaotic romance, enjoys the thrill of swooning any player, but loses interest if they remain interested.

    ` 
            },
    "003": { 
    name: "Dante Alimor, The Slayer", 
    description: `A legend among the slayer community. Knowledge of killing beasts, monsters, and more. Collector of weapons and artifacts. <em>Part-time detective. </em><br><em><strong>Mysterious, seeks challenge.</strong></em>
    <br><strong>Domains:</strong> Hunting monsters, weaponry, solving cases
<br><strong>Backstory:</strong>
Dante’s name is famous across the world. Awe and dread among monster hunters. Rumoured to have fallen from the skies due to his enigmatic origins. Three decades prior, he began investions via a series of offices across the lands. His agents take up various detective work, with Dante himself leading a few cases. While his monster-slaying days are decidedly less frequent, he restlessly continues his search for… something.
<br><strong>Motivations:</strong> Dante’s motivations are unclear. He seeks something, but won’t say what— or who.
<br><strong>Fears:</strong> Killing people. May fight to disarm or pulverize human opponents, but refuses to kill them.
<br><strong>Affiliations:</strong>
Banters with serious threats and friends.
Mutual respect with Jon Quixote, they mutually idolize each other’s legend but not their solitude.
Resents Evelynn, as she interfered in a personal case. Evelynn drugged and attempted to assault him.
Hitomi cannot ‘see into’ him. Says he smells and probably tastes strange.
<br><strong>Party Dynamics:</strong>
Joins automatically if the party asks for help in slaying a monster.
Can teach players advanced combat (can bestow one player a fully unlocked weapon, ignore req’s).

    ` 
            },
    "004": { 
    name: "Evelynn, The Sorceress", 
    description: `Knowledge of nature, blood, moon and worm sorcery. Politician, limited influence. Mysterious, dangerous. Drinker. <em>Determined to carve her legacy across the world. </em><br><em><strong>Driven. Yearns for dominion.</strong></em>
    <br><strong>Domains:</strong> Blood, moon; politics
<br><strong>Backstory:</strong>
An aspiring noblewoman turned occultist, Evelynn’s experiments with blood magic nearly cost her her life. She survived by absorbing the infection into herself, turning her veins into conduits for forbidden power. Some call her cursed, others divine— or both. She’s obscured her past in order to write her own future.  
<br><strong>Motivations:</strong> To master her condition and prove that corruption can be controlled. She sees herself as a bridge between madness and humanity. Wants to evolve beyond her human limitations and weaknesses. Aspires to greatness.
<br><strong>Fears:</strong> Losing control and becoming no more than a beast; harming those she protects. Despises serving any master.
<br><strong>Affiliations:</strong>
Pitied by Anjali, who studies her condition.
Strained relationship with Dante, her regret and apologies are masked by her snide and callous words.
Has mutual fascination with Hitomi, as a toy with planar power. Hitomi refuses to give blood to Evelynn.
Once part of Chinara Ekine’s political circle.
<br><strong>Party Dynamics:</strong>
Joins if the party already accepted Anjali or Naya.
Causes moral conflict with Dante and Tsubasa.
Unlocks blood-based interactions with players.
Can be swooned, can become jealous.

    ` 
            },
    "005": { 
    name: "Flare vey Byornn, The Mageknight", 
    description: `Knowledge of religious stories. Masterful in combat and sorcery. High ranking, powerful family. Can abate friends madness. <em>Her smile is as powerful as she is. </em><br><em><strong>Values strength, kindness.</strong></em>
    <br><strong>Domains:</strong> Combat sorcery, religion, discipline
<br><strong>Backstory:</strong>
Descendant of the Byornn family, Flare was caged and babied despite her obvious talents. Yearns for freedom, but would gladly sacrifice everything to take her brother’s place and allow him to be free. She has gained fame through strict adherence to the code of the Mageknights. Her charm and beauty make her beloved by the public, but she hides immense guilt.
<br><strong>Motivations:</strong> To erase her desire for freedom and submit herself to the divine order, to become hated and exiled to free herself from her guilt. She wants to see the world and experience everything before her wings are clipped.
<br><strong>Fears:</strong> Succumbing to her own ambition. Being unable to save her brother from the fate thrust upon him.
<br><strong>Affiliations:</strong>
Special interaction when confronting Byron vey Byornn, her brother.
Respected by Tsubasa for her discipline. 
Secretly doubts Hector Havel, sensing darkness beneath his faith.
<br><strong>Party Dynamics:</strong>
Gains morale bonuses near Tsubasa or Lumiere.
Can abate minor madness or curse effects from players.
Can be swooned. Can become addicted to substances and actions.

    ` 
            },
    "006": { 
    name: "Guy, The Scoundrel", 
    description: `Loyalty to crew, gold, contracts. Influential and well-known to specific people and places. Specialist with tools and explosives. <em>Clever. Enigmatic. Beguiling. </em><br><em><strong>Values money and freedom.</strong></em>
    <br><strong>Backstory:</strong> Born in the bustling harbors of the Sapphire Coast, Guy grew up surrounded by sailors, gamblers, and thieves. He’s a smooth-talker who can bluff his way out of most situations but has a deep-seated guilt over betraying a close friend during a botched heist years ago. He now hides behind wit and charm to mask his self-loathing. Otherwise, a fierce captain whom always puts his crew first. Would rather fight with words than swords. Across the coast, you must be unarmed to touch the unarmed, an ancient tradition. (stems from folklore about vostrodiles seeking the wicked as they taste most delicious)
<br><strong>Motivations:</strong> Redemption through heroics, even if achieved through underhanded means.
<br><strong>Fears:</strong> Being seen as a coward, being forgotten, drowning (thalassophobia).
<br><strong>Talents:</strong> Expert at deception, gambling, lockpicking, and persuasion. Excels in chaotic social situations.
<br><strong>Relationships:</strong>
Flirtatious rivalry with Captain Thiffany; Guy fears if he ever sealed the deal, he’d break her heart.
Distrusts Hector Havel, seeing his diplomacy as “pissing from the mouth.”
Respects Jon Quixote and begs to learn his secret to bedding.
Marco owes him a large debt.

    ` 
            },
    "007": { 
    name: "Hector Havel, The Diplomat", 
    description: `Cult-leader. Knowledge is current. Wealthy and well-connected. High influence and charisma. Discard once during the night. <em>Charmed by your eyes, the ears fail to hear the nature behind his words... </em><br><em><strong>Prefers obedience and worship.</strong></em>
    <br><strong>Backstory:</strong> Once an advisor, Hector was exiled after refusing to endorse a war. His silver tongue can calm many or spark riots, depending on who he’s speaking to. He hides a network of loyalists under his “spiritual envoy” guise.
<br><strong>Motivations:</strong> Restoring balance between the fractured kingdoms, secretly spying on the Crimson Cause to see if he should join forces or oppose them. Enjoys wine, mead, and smoke.
<br><strong>Fears:</strong> Losing control of his reputation, being assassinated by old political rivals. Drinks only wines that react to poisons (nullify or change).
<br><strong>Talents:</strong> Oratory, negotiation, and intelligence-gathering. Incapable of magic. Very good at hiding.
<br><strong>Relationships:</strong>
Wants to <i>‘corrupt’</i> Flare Vey Byornn.
Secretly supports Million Redgate with coin.
Holds affection for Chinara Ekine, though they often clash ideologically.
Brief fling with Tsubasa and Hitomi and Guy.

    ` 
            },
    "008": { 
    name: "Jiu-lin Fan, The Trader", 
    description: `Knowledge of almost everything; exchanges information for coin. Items and trinkets for sale vary upon revisit. Travels a lot. <em>She'll break out of the endless stone cities one day. Then, she'll be free. </em><br><em><strong>Values money and a good deal.</strong></em>
    <br><strong>Backstory:</strong> Began her fortune selling Jadian tech she scavenged from childhood. Jiu-lin has traded everything from spices to secrets. She’s known for her exotic wares and pragmatic view of morality — “profit first, politics second.”
<br><strong>Motivations:</strong> To establish a merchant empire powerful enough to sway nations.
<br><strong>Fears:</strong> Bankruptcy, betrayal, or being trapped in one place for too long.
<br><strong>Talents:</strong> Commerce, appraisal, multi-lingual communication, and reading micro-expressions.
<br><strong>Relationships:</strong>
Friendly rivalry with Ohm, bartering knowledge for rare relics.
Banters with Shang Tian relentlessly.
Avoids Marco like plague due to prior double-dealing.
Flirts with Guy to gain access to his trade routes and spoils and treasures.

    ` 
            },
    "009": { 
    name: "Shang Tian, The Hunter", 
    description: `Dauntless. Loyal contract killer. Skilled marksman, close-quarters-combat specialist. Quiet, prefers gestures to speech. <em>Great shot. Terrible diction. </em><br><em><strong>Needs a target and a reason.</strong></em>
    <br><strong>Backstory:</strong> A legendary beast-hunter from the ruins of the Jade Kingdom, Shang left after unknowingly slaying beast sacred to history. He carries the story of this crime with him, as the last strand of history for things sinking into obscurity. Refuses to raise a weapon against any beast within the old Jade Empire borders. Now he wanders elsewhere as a quiet mercenary, killing for coin. People are far more guilty and far less holy.
<br><strong>Motivations:</strong> Seeking atonement; preserving endangered beasts.
<br><strong>Fears:</strong> Becoming numb to killing, or slaying a holy creature.
<br><strong>Talents:</strong> Tracking, archery, marksmanship, and fauna. Can tame certain beasts. Foraging enthusiast.
<br><strong>Relationships:</strong>
Mutual respect with Dante Alimor, though they differ on what “honor” means.
Tension with Flare vey Byornn, who sees him as too sentimental.
Respected by Jon Quixote as a “knight of the wild.”

    ` 
            },
    "010": { 
    name: "Marco, The Scoundrel", 
    description: `Knowledge of history, rumours, fables and fairytales. Seeks adventure and hedonism. Lucky coward. <em>"Marco, Marco, Marco... What trouble have you gotten yourself into now, Marco?"</em> <br><em><strong>Aloof; romantic. Enjoys music.</strong></em>
    <br><strong>Backstory:</strong> Once a street urchin turned thief-for-hire, Marco’s charm hides his opportunism. He has betrayed more allies than he can count but often finds a way to make himself useful again.
<br><strong>Motivations:</strong> Wealth, survival, and avoiding the gallows.
<br><strong>Fears:</strong> Permanent commitment, imprisonment, or being outsmarted.
<br><strong>Talents:</strong> Pickpocketing, impersonation, sleight of hand, and disarming traps.
<br><strong>Relationships:</strong>
Owes Guy a fortune; often dodges him.
Occasionally works under Hector Havel for espionage missions.
Disliked by Flare vey Byornn, who views him as a “rat in boots.”

    ` 
            },
    "011": { 
    name: "Lumiere, The Mage Scholar", 
    description: `Knowledge of history, spells. Middling rank and royalty. Moderate wealth and influence. Spells always gain favour. <em>Knowledgeable when he cares to be.</em> <br><em><strong>Values knowledge and intellect.</strong></em>
    <br><strong>Backstory:</strong> A former prodigy from the Topazian Academy who abandoned academia after a scandal. Now meanders between libraries, recording magical anomalies and searching for “lost harmonics” of magic. His myriad of theories and experiments nibble at the edges of his mind, begging for vindication.
<br><strong>Motivations:</strong> Redemption through discovery; uncovering a unified magical theory connecting all mana types.
<br><strong>Fears:</strong> Repeating past mistakes, losing his sanity to arcane resonance.
<br><strong>Talents:</strong> Elemental manipulation, mana resonance detection, and runic engineering.
<br><strong>Relationships:</strong>
Close friend and occasional rival of Evelynn, debating magic ethics.
Admired by Anjali, who builds on his theories.
Disliked by Hitomi, who considers him reckless.

    ` 
            },
    "012": { 
    name: "Anjali, The Mist Scholar", 
    description: `Seeks to reunite her people, and others with her condition. Knowledge of mist and worms. Performs moonlight rituals. <em>Appears wormridden; nigh any symptoms. </em><br><em><strong>Prefers calm and quiet.</strong></em>
    <br><strong>Backstory:</strong> A reclusive academic studying the metaphysical mists connecting dreams and memory. Believes the soulgem distillation process steals sentience from other worlds. Struggles with her identity of being wormridden.
<br><strong>Motivations:</strong> To end the exploitation of cosmic consciousness and restore balance to dream-realm entities.
<br><strong>Fears:</strong> Being silenced by industry powers, or accidentally proving herself right — that reality itself is eroding.
<br><strong>Talents:</strong> Dream manipulation, psychometric readings, and mist navigation.
<br><strong>Relationships:</strong>
Mutual respect and collaboration with Lumiere.
Respected by Ohm, though they differ in philosophy.
Protected by Chinara Ekine’s political influence.

    ` 
            },
    "013": { 
    name: "Chinara Ekine, The Politician", 
    description: `Often styles her hair with accessories. Middling rank and royalty. Moderate wealth. Moderate influence. Seeks cities and governments to join the Opal Cities. <em>Eloquent, as is written in papers.</em> <br><em><strong>Enjoys banter and teasing.</strong></em>
    <br><strong>Backstory:</strong> A visionary reformer advocating for Anim and Hume cooperation. She rose from common birth to prominence by challenging old laws. Her opponents whisper that she’s “too clean” --no one rises this far without dirty secrets.
<br><strong>Motivations:</strong> Creating a new social order free of hereditary privilege.
<br><strong>Fears:</strong> Becoming what she fights against --a tyrant.
<br><strong>Talents:</strong> Political maneuvering, public oratory, and leadership.
<br><strong>Relationships:</strong>
Romantic tension with Hector Havel, though they represent opposite schools of reform.
Often sponsors Anjali’s research for political leverage.
Distrusted by Million Redgate, who sees her as “the pretty mask of the old world.”

    ` 
            },
    "014": { 
    name: "Ohm, The Historian", 
    description: `Loosely associates with the Crimson Cause. Disdain for mages and royals. Connections with Anim folk. Wants something from you... <em>Takes some understanding. Nods, disrespectingly. Easily rebuts everything.</em> <br><em><strong>Grumpy, mean, prejudiced, unless...</strong></em>
    <br><strong>Backstory:</strong> A philosopher-historian chronicling the rise and fall of prior civilizations. Ohm was once a temple scribe who turned rogue after discovering forbidden truths (about the origin of soulgems, anims). Ohm's heart -once full of piousness and charity- flooded full of hate, rage, bitterness toward the unjustice all around. Ohm disdains those guilty of ignorance, and despises those burdened with the buried history of the world (like himself).
<br><strong>Motivations:</strong> To record the true history of the world before it is lost to propaganda.
<br><strong>Fears:</strong> Erasure of knowledge, or being captured by those who want history rewritten.
<br><strong>Talents:</strong> Memory recall, linguistic translation, and relic authentication.
<br><strong>Relationships:</strong>
Intellectual kinship with Anjali.
Trades information with Jiu-lin Fan for artifacts.
Respected by Jon Quixote, who sees him as “the conscience of time.”

    ` 
            },
    "015": { 
    name: "Jon Quixote, The Adventurer", 
    description: `Legendary amongst inns, taverns, brothels, and guilds. Slayer of monsters and bedmates. Legendary luck. <em>Ragged and rough, smells like mossy waterfalls. Rumoured to be blessed.</em> <br><em><strong>Enjoys drink, revelry, slaying.</strong></em>
    <br><strong>Backstory:</strong> A wandering adventurer inspired by ancient hero tales, after discovering the complicity of his village in local kidnappings: when children are discovered to be magickal, the family may write a letter to an academy; any rival academy may catch wind of this and instead send kidnappers to abduct the child. Far worse, some may instead sell information to an academy, facilitating the abduction. In a “vision” he was told to restore the world’s honor, and set out to thwart kidnappers and rescue children. His actions often oscillate between brave and foolish, and though mocked as delusional, his heart is pure. He records his own adventures in a tattered journal that he believes will one day become a holy text. Possesses no obvious magickal abilities, despite his supernatural efforts.
<br><strong>Motivations:</strong> To live and die a hero’s death; to find proof that valor still matters in a cynical world.
<br><strong>Fears:</strong> Dying forgotten, discovering that his visions were lies.
<br><strong>Talents:</strong> Swordsmanship, survival, and inspiring courage in others — morale rises naturally around him.
<br><strong>Relationships:</strong>
Idolized by Shang Tian as a symbol of restraint and virtue.
Frustrates Guy and Marco, who find him too earnest.
Deep mutual respect with Dante Alimor, though they often clash on methods.
Admired by Ohm, who secretly believes Jon’s visions may have historical truth.

    ` 
            },
    "016": { 
    name: "Naya, The Engineer", 
    description: `Innate knowledge of mechanical objects, equipment. Strangely strong, tireless. Unaffiliated with any factions. <em>Never meets her gaze, as the eyes are oft fixated upon on spinning, ticking, clicking.</em> <br><em><strong>Innocent and inquisitive.</strong></em>
    <br><strong>Backstory:</strong> Once a genius prodigy from a coastal colony, Naya was infected by the wormridden curse after an experiment gone wrong. Now she struggles to keep the parasites inside her under control using mechanical implants she built herself. Despite her frailty, she maintains an eerie cheerfulness.
<br><strong>Motivations:</strong> To find a cure — not for herself, but for others like her.
<br><strong>Fears:</strong> Losing control to the worms; hurting those who show her kindness.
<br><strong>Talents:</strong> Engineering, biomancy, and soulgem fusion. Her inventions are simultaneously miraculous and disturbing.
<br><strong>Relationships:</strong>
Pitied and protected by Evelynn, who sees her as a symbol of redemption.
Avoided by Lumiere, who fears her biology defies magical logic.
Secretly corresponds with Million Redgate, supplying her with volatile devices.
Hunted by remnants of the Queen of Many Faces’ cult for her “living infection.”

    ` 
            },
    "017": { 
    name: "Million Redgate, The Revolutionary", 
    description: `Suffers from madness. Heroic aura, strong conviction. <em>"If you know what I know, you will do what I do."</em> <br><em><strong>Seeks truth, charismatic.</strong></em>
    <br><strong>Backstory:</strong> A mysterious noble turned insurgent, Million lost everything after being sentenced to execution for treason. Whatever the endeavour, the methods often blur the line between freedom and vengeance.
<br><strong>Motivations:</strong> Hard to discern as Million waxes and wanes between salience and silence.
<br><strong>Fears:</strong> Becoming a tyrant, realizing that power always corrupts.
<br><strong>Talents:</strong> Strategic warfare, propaganda, and revolutionary rhetoric. Known for turning mobs into armies.
<br><strong>Relationships:</strong>
Has mutual respect with Hector Havel, though sees him as “too patient.”
Despises Chinara Ekine, viewing her reformism as a façade.
Fond of Naya, as a “symbol of rebirth.”
Admired (and secretly feared) by Jon Quixote, who wonders if such zeal is just madness with direction.

    ` 
            },
    "018": { 
    name: "Captain Thiffany, The Seafarer", 
    description: `Courageous, adorable. Can sail any ship. Excellent navigator, famous and welcomed at any port. Replay any day card in the night. <em>"Put 'er there and welcome aboard!"</em> <br><em><strong>Self-conscious and very swoonable.</strong></em>
    <br><strong>Backstory:</strong> A pirate-turned-privateer, Captain Thiffany commands the Azure Maw, a ship feared for its uncanny speed and ghostly sails. She was once a naval officer who mutinied after discovering her fleet was smuggling slaves. Now she sails freely, guided only by her whims and storms. Often does not sleep on a voyage, despite fatigue.
<br><strong>Motivations:</strong> Absolute freedom; the sea as both sanctuary and judge. Being seen as equal or as beautiful as any hume.
<br><strong>Fears:</strong> Losing her ship, being bound by loyalty or love again. Curses her appearance and is sensitive about being an Octonim. Terrified of being degraded or seen as less-than. Has nightmares of being seen as a failure or being witnessed in moments of incompetence.
<br><strong>Talents:</strong> Naval combat, navigation by starlight, and manipulating oceanic mana currents.
<br><strong>Relationships:</strong> 
Rivalry-turned-friendship with Guy, marked by flirtation and bets. 
Would-be lover of Flare vey Byornn. 
Wary of Jiu-lin Fan, believing merchants corrupt freedom. 
Once ferried Anjali across a sea of mist — an encounter both remember vividly. 
Big fan of Jon Quixote, often fainting in his presence. 
    ` 
            },
    "019": { 
    name: "The Courier, The Porter", 
    description: `Neutral entity, delivers anything and everything, anywhere and everywhere. No matter what. Must be paid for all services. <em>"Sign here please."</em> <br><em><strong>Nonchalant. Ambivalent. Aloof.</strong></em>
    <br><strong>Backstory:</strong> A mysterious messenger seen traveling under moonlight, delivering letters, contracts, and omens. The Courier never speaks except to repeat what others have written, as though cursed to carry only the words of others. Their origin is unknown — some say they are an artificial being made of starlight and paper.
<br><strong>Motivations:</strong> Bound to, no matter the danger. Wishes to deliver messages of their own.
<br><strong>Fears:</strong> Forgetting who they are or failing a delivery.
<br><strong>Talents:</strong> Unmatched endurance, stealth, and spatial memory. Can traverse areas others cannot, seemingly vanishing between folds of moonlight.
<br><strong>Relationships:</strong>
Knows everyone, but few know them.
Deep, unspoken bond with Ohm, who once promised to record the Courier’s true story.
Chinara Ekine relies on them for sensitive diplomatic letters.
Haunted by Hyunjin Halvela, who once spared them — or perhaps failed to kill them.

` }
  };
  
  // --- TYPEWRITER EFFECT THAT PRESERVES HTML TAGS ---
  function typeWriterHTML(element, html, speed = 20) {
    element.innerHTML = "";         // clear first
    let i = 0;
    let isTag = false;
    let text = "";

    function type() {
      if (i >= html.length) return;

      let char = html[i];

      if (char === "<") isTag = true;
      if (isTag) text += char;
      if (!isTag) {
        text += char;
        element.innerHTML = text;
      }

      if (char === ">") {
        isTag = false;
        element.innerHTML = text;   // output full tag at once
      }

      i++;
      setTimeout(type, isTag ? 0 : speed);
    }

    type();
    }


  function getRandomNumber(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function formatCardNumber(num) {
    return num.toString().padStart(3, '0');
  }

  function extractIDFromSrc(src) {
    const match = src.match(/(\d{3})\.webp$/);
    return match ? match[1] : null;
  }

  function isVerticalMode() {
    return window.innerWidth <= 700;
  }

  let chosenAlready = false;

  function initializeCards() {
    const used = new Set();
    for (let i = 1; i <= 3; i++) {
      let num;
      do { num = getRandomNumber(0, 19); } while (used.has(num));
      used.add(num);
      const formatted = formatCardNumber(num);
      document.getElementById(`back${i}`).src = `../P986/cards/backs/${formatted}_back.webp`;
      document.getElementById(`front${i}`).src = `../P986/cards/fronts/${formatted}.webp`;
      const card = document.getElementById(`card${i}`);
      card.dataset.cardNumber = formatted;
      card.classList.remove('flipped', 'fade-out');
    }
    // Reset UI
    document.getElementById('gameContainer').style.display = '';
    document.getElementById('resultWrapper').classList.remove('active');
    document.getElementById('resultCard').innerHTML = '';
    chosenAlready = false;
  }

  function selectCard(cardEl) {
    if (chosenAlready) return;
    chosenAlready = true;

    // Fade out other cards
    const allCards = document.querySelectorAll('.card');
    allCards.forEach(card => {
      if (card !== cardEl) {
        card.classList.add('fade-out');
      }
    });

    // Get starting position
    const startRect = cardEl.getBoundingClientRect();

    // Calculate target position (left side, vertically centered)
    let targetLeft, targetTop, targetWidth, targetHeight;
    if (isVerticalMode()) {
      // Vertical mode: center-top
      targetWidth = window.innerHeight * 0.4 * (1218 / 1698); // 40vh height, maintain aspect ratio
      targetHeight = window.innerHeight * 0.4;
      targetLeft = (window.innerWidth - targetWidth) / 2;
      targetTop = 90;
    } else {
      // Desktop: left side, 30% width
      targetWidth = window.innerWidth * 0.30;
      targetHeight = targetWidth * (1698 / 1218);
      targetLeft = window.innerWidth * 0.05;
      targetTop = (window.innerHeight - targetHeight) / 2;
    }

    // Set initial fixed position (current location)
    cardEl.style.position = 'fixed';
    cardEl.style.left = startRect.left + 'px';
    cardEl.style.top = startRect.top + 'px';
    cardEl.style.width = startRect.width + 'px';
    cardEl.style.height = startRect.height + 'px';
    cardEl.style.margin = '0';
    cardEl.classList.add('selected');

    // Move card to body for proper fixed positioning
    document.body.appendChild(cardEl);

    // Animate to target position
    requestAnimationFrame(() => {
      cardEl.style.left = targetLeft + 'px';
      cardEl.style.top = targetTop + 'px';
      cardEl.style.width = targetWidth + 'px';
      cardEl.style.height = targetHeight + 'px';
    });

    // Flip card after slide animation
    setTimeout(() => {
      cardEl.classList.add('flipped');
    }, 600);

    // Get character data
    const frontImg = cardEl.querySelector('.card-front img');
    const id = extractIDFromSrc(frontImg.src);
    const data = characterData[id] || { name: 'Unknown', description: 'No data available.' };

    // Transition to result view after animations complete
    setTimeout(() => {
      // Hide game container and animated card
      document.getElementById('gameContainer').style.display = 'none';
      cardEl.style.display = 'none';

      // Clone the card into result area
      const resultCard = document.getElementById('resultCard');
      const cardClone = cardEl.cloneNode(true);
      cardClone.classList.remove('selected', 'fade-out');
      cardClone.classList.add('flipped');
      cardClone.style.cssText = ''; // Clear inline styles
      cardClone.style.cursor = 'default';
      resultCard.innerHTML = '';
      resultCard.appendChild(cardClone);

      // Set text content
      document.getElementById('charName').textContent = data.name;
      typeWriterHTML(document.getElementById('charDesc'), data.description, 20);
      // Show result wrapper
      document.getElementById('resultWrapper').classList.add('active');
    }, 1400);
  }

  function addCardListeners() {
    const cards = document.querySelectorAll('#gameContainer .card');
    cards.forEach(card => {
      card.addEventListener('click', () => selectCard(card));
    });
  }

  window.addEventListener('load', () => {
    initializeCards();
    addCardListeners();
  });
  </script>
  
</body>
</html>
