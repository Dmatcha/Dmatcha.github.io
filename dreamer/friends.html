<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Friends - DEANSand</title>
  <link rel="stylesheet" href="style.css">
  <style>
    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      min-height: 100%;
      background: #0a0a0a;
      font-family: Georgia, serif;
    }

    /* VIDEO BACKGROUND */
    .video-bg {
      position: absolute;
      top: 50%;
      left: 50%;
      min-width: 100%;
      min-height: 100%;
      width: auto;
      height: auto;
      transform: translate(-50%, -50%);
      object-fit: cover;
      filter: blur(2px) brightness(0.95) contrast(1.1);
      opacity: 0;
      pointer-events: none;
      transition: transform 0.3s ease, opacity 0.5s ease;
    }

    /* Fade in video when loaded */
    .video-bg.loaded {
      opacity: 0.99;
    }

    /* Return button */
    .return-button {
      position: fixed;
      top: 20px;
      left: 20px;
      background: white;
      color: black;
      padding: 10px 18px;
      border-radius: 5px;
      text-decoration: none;
      z-index: 2000;
      transition: background 0.3s ease, color 0.3s ease;
    }

    .return-button:hover {
      background: red;
      color: white;
    }

    /* Ensure content is above video */
    .game-container,
    .result-wrapper {
      position: relative;
      z-index: 1;
    }

    /* ============================================
       GAME CONTAINER - Selection Phase
       ============================================ */
    .game-container {
      width: 100%;
      min-height: 100vh;
      padding-top: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .cards-row {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-evenly;
      padding: 2%;
    }

    /* Card slot - 30% width, aspect ratio preserved */
    .card-slot {
      width: 30%;
      aspect-ratio: 1218 / 1698;
      position: relative;
    }

    .card {
      width: 100%;
      height: 100%;
      cursor: pointer;
      perspective: 1200px;
      position: relative;
      transition: transform 0.3s ease;
    }

    .card:hover {
      transform: scale(1.03);
    }

    .card-inner {
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 0.6s ease;
      position: relative;
    }

    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    .card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 22px;
      box-shadow: 0 8px 21px rgba(240,100,20,0.35);
      overflow: hidden;
      background: #222;
    }

    .card-back {
      transform: rotateY(0deg);
    }

    .card-front {
      transform: rotateY(180deg);
      background: #fff;
    }

    .card-face img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    /* ============================================
       RESULT PHASE
       ============================================ */
    .result-wrapper {
      width: 100%;
      min-height: 100vh;
      display: none;
      align-items: center;
      justify-content: space-around;
      padding: 80px 5% 40px 5%;
    }

    .result-wrapper.active {
      display: flex;
    }

    /* Result card - fixed width, maintain aspect ratio */
    .result-card {
      width: 30vw;
      aspect-ratio: 1218 / 1698;
      position: relative;
    }

    .result-card .card-inner {
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 0.6s ease;
    }

    .result-card .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    /* Floating text card */
    .floating-text-card {
      width: 35%;
      max-width: 600px;
      min-width: 300px;
      max-height: 80vh;
      overflow-y: auto;
      background: rgba(0, 0, 0, 0.7);
      padding: 30px;
      border-radius: 20px;
      color: white;
      font-size: 16px;
      line-height: 1.6;
      text-align: left;
    }

    .char-name {
      font-size: 2.5em;
      margin-bottom: 20px;
      color: #ffeb3b;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }

    .char-desc {
      white-space: pre-line;
    }

    /* Fade animation for selection */
    .fade-out {
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    /* Selected card highlight */
    .selected {
      box-shadow: 0 0 30px rgba(255, 235, 59, 0.8);
      transform: scale(1.05);
    }

    /* Responsive design */
    @media (max-width: 900px) {
      /* Cards row becomes vertical stack */
      .cards-row {
        flex-direction: column;
        gap: 20px;
      }

      /* In vertical mode: height = 30vh, width auto-calculated */
      .card-slot {
        width: auto;
        height: 30vh;
        aspect-ratio: 1218 / 1698;
      }

      /* Result wrapper stacks vertically */
      .result-wrapper.active {
        flex-direction: column;
        align-items: center;
        gap: 20px;
        padding: 80px 5% 40px 5%;
      }

      /* Result card - height limited to 40vh in vertical mode */
      .result-card {
        width: auto;
        height: 40vh;
        aspect-ratio: 1218 / 1698;
      }

      /* Text card goes below, full width, scrollable */
      .floating-text-card {
        width: 90%;
        max-width: none;
        min-width: auto;
        max-height: none;
        overflow-y: visible;
      }
    }
    @media (min-width: 901px) {  .card-face { border-radius: 36px;  }  }
  </style>
</head>
<body>
  <!-- VIDEO BACKGROUND -->
  <video class="video-bg" autoplay muted loop playsinline preload="auto">
    <source src="media/138556-769988117_medium.mp4" type="video/mp4" />
    Your browser does not support the video tag.
  </video>

  <a class="return-button" href="dreamer.html">Return To Dreaming</a>

  <!-- SELECTION PHASE -->
  <div class="game-container" id="gameContainer">
    <div class="cards-row" id="cardsRow"></div>
  </div>

  <!-- RESULT PHASE -->
  <div class="result-wrapper" id="resultWrapper">
    <div class="result-card" id="resultCard"></div>
    <div class="floating-text-card" id="floatingText">
      <h2 class="char-name" id="charName"></h2>
      <p class="char-desc" id="charDesc"></p>
    </div>
  </div>

<script src="script.js"></script>

<script>
const characterData = {
  "000": { 
    name: "Hitomi, The Aloof Sorceress", 
    description: `
    Knowledge of Jade Tech and Empire, soulgems and distilleries. Aware of far-off planes and future events. Penchant for lies and thievery. Her irreverence waxes and wanes with the moon. <em>Occasionally speaks and moves as if puppeted by an unseen master.</em> 
        <br><em><strong>Prefers whimsy; hates seriousness.</strong></em>
        <br><strong>Domains:</strong> Jade Tech, soulgems, distilleries, planes of existence.
        <br><strong>Backstory:</strong>
        Hitomi once served as a researcher in the Topazian capital's Ministry of Distillation and Utilization, specializing in the early refinement of soulgems and their applications. She vanished after a disastrous experimentâ€” failure during the crystallization compression phase, half-formed gems reverted immediately back to soulgas instead of souldust. The rapid expansion broke open the canisters, but instead of exploding, soulgas whirled around the room, moving as if it were alive. Some say she was briefly possessed by an entity from a place beyond, although the reports merely state she collapsed due to inhalation of soulgas. After her reappearance, she was found unfit to continue working, malaise coupled with knowledge that defies linear time. Now, she wanders towns and cities, always barely enough coin in hand, humming prophecy or madness.
        <br><strong>Motivations:</strong> Hitomi grapples with having glimpsed other worlds and lived other lives, returning her sanity would mean erasing the myriad of minds that coexist within her. Sometimes she acts and speaks as if some unseen master whispers through her. She hides this truth from everyone. For now, she simply wants somewhere to belong, somewhere she won't be judged by her failures.
<br><strong>Fears:</strong> Losing autonomy to the presences inside her; confronting what her research lead to.
<br><strong>Affiliations:</strong>
Has a cautious professional respect for Lumiere, whose Topazian ties mirror her past.
    ` 
            }
};

// Add more character data here (truncated for brevity)
characterData["001"] = { name: "Evelynn, The Redeemed", description: "A fallen angel seeking redemption through acts of service..." };
characterData["002"] = { name: "Lumiere, The Lightbringer", description: "Bearer of the eternal flame, sworn to protect the innocent..." };

let selectedCards = [];

function initializeCards() {
  const cardsRow = document.getElementById('cardsRow');
  cardsRow.innerHTML = '';

  for (let i = 0; i < 3; i++) {
    const cardSlot = document.createElement('div');
    cardSlot.className = 'card-slot';
    
    const card = document.createElement('div');
    card.className = 'card';
    card.dataset.cardId = '000'; // Default card
    
    const cardInner = document.createElement('div');
    cardInner.className = 'card-inner';
    
    const cardBack = document.createElement('div');
    cardBack.className = 'card-face card-back';
    const backImg = document.createElement('img');
    backImg.src = 'cards/backs/000_back.webp';
    backImg.alt = 'Card Back';
    cardBack.appendChild(backImg);
    
    const cardFront = document.createElement('div');
    cardFront.className = 'card-face card-front';
    const frontImg = document.createElement('img');
    frontImg.src = 'cards/fronts/000.webp';
    frontImg.alt = 'Card Front';
    cardFront.appendChild(frontImg);
    
    cardInner.appendChild(cardBack);
    cardInner.appendChild(cardFront);
    card.appendChild(cardInner);
    cardSlot.appendChild(card);
    cardsRow.appendChild(cardSlot);
  }
}

function selectCard(cardEl) {
  if (selectedCards.length >= 1) return; // Only select one card
  
  cardEl.classList.add('selected');
  selectedCards.push(cardEl);
  
  // Fade out other cards
  const allCards = document.querySelectorAll('#gameContainer .card');
  allCards.forEach(card => {
    if (!card.classList.contains('selected')) {
      card.classList.add('fade-out');
    }
  });
  
  setTimeout(() => {
    showResult(cardEl);
  }, 1400);
}

function showResult(cardEl) {
  // Hide game container
  document.getElementById('gameContainer').style.display = 'none';
  
  const cardId = cardEl.dataset.cardId;
  const data = characterData[cardId];
  
  // Clone the card into result area
  const resultCard = document.getElementById('resultCard');
  const cardClone = cardEl.cloneNode(true);
  cardClone.classList.remove('selected', 'fade-out');
  cardClone.classList.add('flipped');
  cardClone.style.cssText = '';
  cardClone.style.cursor = 'default';
  resultCard.innerHTML = '';
  resultCard.appendChild(cardClone);

  // Set text content
  document.getElementById('charName').textContent = data.name;
  typeWriterHTML(document.getElementById('charDesc'), data.description, 20);
  // Show result wrapper
  document.getElementById('resultWrapper').classList.add('active');
}

function addCardListeners() {
  const cards = document.querySelectorAll('#gameContainer .card');
  cards.forEach(card => {
    card.addEventListener('click', () => selectCard(card));
  });
}

function typeWriterHTML(element, html, speed) {
  element.innerHTML = '';
  const tempDiv = document.createElement('div');
  tempDiv.innerHTML = html;
  const text = tempDiv.innerHTML;
  let i = 0;
  
  function type() {
    if (i < text.length) {
      element.innerHTML += text.charAt(i);
      i++;
      setTimeout(type, speed);
    }
  }
  type();
}

window.addEventListener('load', () => {
  initializeCards();
  addCardListeners();
});
</script>

</body>
</html>