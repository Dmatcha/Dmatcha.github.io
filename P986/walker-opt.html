<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gameplay Guide - Linear Chance System</title>
<link rel="stylesheet" href="style.css">
<style>
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

* { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Roboto', sans-serif; }

body {
  background: #0a0a0a;
  color: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  overflow: hidden;
}

/* VIDEO BACKGROUND */
.video-bg {
  position: absolute;
  top: 50%;
  left: 50%;
  min-width: 100%;
  min-height: 100%;
  width: auto;
  height: auto;
  transform: translate(-50%, -50%);
  object-fit: cover;
  filter: blur(2px) brightness(0.95) contrast(1.1);
  opacity: 0;
  pointer-events: none;
  transition: transform 0.3s ease, opacity 0.5s ease;
}

/* Fade in video when loaded */
.video-bg.loaded {
  opacity: 0.99;
}

@media (orientation: portrait) {
  .video-bg {
    transform: translate(-50%, -50%) rotate(90deg);
    min-width: 100%;
    min-height: 100%;
  }
}

/* Main card container */
.container {
  width: 60vw;
  max-width: 520px;
  height: 80vh;
  border-radius: 16px;
  padding: 24px;
  box-shadow: 0 0 25px rgba(0,0,0,0.6);
  text-align: center;
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  transition: background 0.8s ease;
  z-index: 2;
}

/* Day and night background themes */
.container.day-theme {
  background: linear-gradient(145deg, #943a09, #f29422);
  box-shadow: 0 0 40px rgba(240,200,30,0.5);
}

.container.night-theme {
  background: linear-gradient(135deg, #202050, #0E0E20);
  box-shadow: 0 0 40px rgba(100,100,255,0.5);
}

/* Header */
.header { display: flex; justify-content: space-between; margin-bottom: 12px; }
.day-label, .slot-label { font-size: 1.45rem; font-weight: bold; }

/* Central text area */
.text-area {
  flex: 1;
  margin: 16px 0;
  background: rgba(255,255,255,0.05);
  border-radius: 8px;
  padding: 16px;
  overflow-y: auto;
  text-align: left;
  line-height: 1.5;
  font-size: 1.33rem;
}

/* Buttons */
.button {
  width: 100%;
  padding: 14px;
  margin: 8px 0;
  border: none;
  border-radius: 12px;
  font-size: 1.50rem;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.35s ease;
}
.button:disabled { opacity: 0.4; cursor: default; }

.act-btn { background: #ffb347; color: #1e1e2f; }
.map-btn { background: #ffd700; color: #1e1e2f; }
.next-btn { background: #ff7f50; color: #fff; }
.dawn-btn { background: #87ceeb; color: #1e1e2f; }
.night-btn { background: #6a5acd; color: #fff; }
.interstitial-btn { background: #ff6347; color: #fff; }

/* Checkbox styling */
.checkbox {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  padding: 12px;
  margin: 8px 0;
  border-radius: 12px;
  border: 2px solid #fff;
  cursor: pointer;
  transition: all 0.5s;
  user-select: none;
  font-size: 1.25rem;
}
.checkbox.checked {
  background: #32cd32;
  color: #1e1e2f;
}

/* Reset button */
.reset-btn {
  position: absolute;
  top: 16px;
  left: 16px;
  padding: 8px 12px;
  background: #ff4d4d;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  color: #fff;
  font-weight: bold;
  z-index: 5;
}

/* Scrollbar styling */
.text-area::-webkit-scrollbar { width: 8px; }
.text-area::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.2);
  border-radius: 4px;
}
.text-area::-webkit-scrollbar-thumb:hover {
  background: rgba(255,255,255,0.4);
}
.button.interstitial-btn {
  opacity: 0.4;
  transition: all 0.5s ease;
}
.button.interstitial-btn.active {
  opacity: 1;
}

/* Mobile: use wider relative width */
@media (max-width: 600px) {
  .container {
    width: 92vw;
    max-width: none;
    min-width: 300px;
  }
}

/* Flavor text styling by pool */
.pool-0 { color: #87ceeb; font-style: italic; }
.pool-1 { color: #ffd700; font-style: italic; }
.pool-2 { color: #98fb98; font-style: italic; }
.pool-3 { color: #dda0dd; font-style: italic; }
.pool-4 { color: #ff69b4; font-style: italic; }
</style>
</head>
<body>

  <!-- ðŸ” VIDEO BACKGROUND -->
  <video class="video-bg" autoplay muted loop playsinline preload="auto">
    <source src="media/12530-239934669_medium.mp4" type="video/mp4" />
    Your browser does not support the video tag.
  </video>

<button class="reset-btn" onclick="resetGame()">RESET</button>

<div class="container">
  <div class="header">
    <div class="day-label" id="dayLabel">DAWN of Cycle 1</div>
    <div class="slot-label" id="slotLabel">[0]</div>
  </div>

  <div class="text-area" id="textArea">ZERODAWN <br>YOU SHOULD NOT SEE THIS!
  </div>
  
  <div id="checkboxes" style="display:none;">
    <div class="checkbox" id="actCheckbox">ACT</div>
    <div class="checkbox" id="mapCheckbox">REVEAL</div>
  </div>
  
  <button class="button" id="mainButton">CONTINUE</button>
</div>

<script src="script.js"></script>

<script>
// Game state variables
let cycle = 1, slot = 0, isNight = false, nightStep = 0, phaseMode = null;
const daySlots = 11, nightSlots = 6;

// DOM elements
const dayLabel = document.getElementById('dayLabel');
const slotLabel = document.getElementById('slotLabel');
const textArea = document.getElementById('textArea');
const mainButton = document.getElementById('mainButton');
const checkboxesDiv = document.getElementById('checkboxes');
let actCheckbox = document.getElementById('actCheckbox');
let mapCheckbox = document.getElementById('mapCheckbox');

function ordinal(num) {
  const s = ["th", "st", "nd", "rd"], v = num % 100;
  return num + (s[(v-20)%10] || s[v] || s[0]);
}

function setContainerTheme(theme) {
  const container = document.querySelector('.container');
  container.className = 'container ' + theme + '-theme';
}

function updateUI() {
  dayLabel.innerText = isNight ? `Night ${nightStep + 1}` : `DAWN of Cycle ${cycle}`;
  slotLabel.innerText = `[${slot}]`;
  setContainerTheme(isNight ? 'night' : 'day');
}

function toggleCheckbox() {
  this.classList.toggle('checked');
}

function cleanupTransientButtons() {
  document.querySelectorAll('.button:not(#mainButton)').forEach(btn => btn.remove());
}

function showDuskChoice() {
  isNight = true;
  setContainerTheme('night');
  dayLabel.innerText = "DUSK of Cycle " + cycle;
  textArea.innerHTML = "Choose your path...";
  
  checkboxesDiv.style.display = 'none';
  mainButton.style.display = 'none';
  
  const container = document.querySelector('.container');

  const dawnBtn = document.createElement('button');
  dawnBtn.className = 'button dawn-btn';
  dawnBtn.innerText = 'End the day';
  dawnBtn.disabled = true;

  const nightBtn = document.createElement('button');
  nightBtn.className = 'button night-btn';
  nightBtn.innerText = 'Enter the NIGHT';
  nightBtn.disabled = true;

  container.appendChild(dawnBtn);
  container.appendChild(nightBtn);

  setContainerTheme('night'); // transition during dusk

  let cooldown = 3;
  const interval = setInterval(() => {
    cooldown--;
    if (cooldown <= 0) {
      dawnBtn.disabled = false;
      nightBtn.disabled = false;
      clearInterval(interval);
    }
  }, 1000);

  dawnBtn.addEventListener('click', () => {
    dawnBtn.remove(); nightBtn.remove();
    goToDawn(true);
  });

  nightBtn.addEventListener('click', () => {
    dawnBtn.remove(); nightBtn.remove();
    isNight = true;
    nightStep = 0;
    slot = 12;
    updateUI();
  });
}

function goToDawn(isNewCycle) {
  if (isNewCycle) cycle++;
  isNight = false; nightStep = 0;
  slot = 0;
  cleanupTransientButtons();
  
  checkboxesDiv.style.display = 'flex';
  actCheckbox.classList.remove('checked');
  mapCheckbox.classList.remove('checked');
  
  dayLabel.innerText = "DAWN of Cycle " + cycle;
  slotLabel.innerText = "[0]";
  textArea.innerHTML = "All players gain <strong>one level!</strong> <br>All players regain all <strong>light mana!</strong>";
  
  mainButton.innerText = "CONTINUE";
  mainButton.disabled = false;
  mainButton.style.display = 'block';
  setContainerTheme('day');
}

function showContinueNightInterstitial() {
  checkboxesDiv.style.display = 'none';
  mainButton.style.display = 'none';
  textArea.innerHTML = "Choose your next action wisely...";

  const endBtn = document.createElement('button');
  endBtn.className = 'button interstitial-btn';
  endBtn.innerText = 'Loot rewards, proceed to the DAWN!';
  endBtn.disabled = true;

  const contBtn = document.createElement('button');
  contBtn.className = 'button interstitial-btn';
  contBtn.innerText = 'Continue deeper into the NIGHT...';
  contBtn.disabled = true;

  const container = document.querySelector('.container');
  container.appendChild(endBtn);
  container.appendChild(contBtn);

  let cooldown = 1;
  const interval = setInterval(() => {
    cooldown--;
    if (cooldown <= 0) {
      endBtn.disabled = false;
      contBtn.disabled = false;
      endBtn.classList.add('active');
      contBtn.classList.add('active');
      clearInterval(interval);
    }
  }, 1000);

  endBtn.addEventListener('click', () => {
    endBtn.remove(); contBtn.remove();
    goToDawn(true);
  });

  contBtn.addEventListener('click', () => {
    endBtn.remove(); contBtn.remove();
    nightStep++;
    slot++;
    updateUI();
  });
}

function showDeepOfNight() {
  phaseMode = 'deep';
  setContainerTheme('night');
  dayLabel.innerText = `The Deep Of The ${ordinal(cycle)} Night`;
  slotLabel.innerText = "[17]";
  textArea.innerHTML = "Congratulations, you have survived the night...";

  checkboxesDiv.innerHTML = '';
  const lootBtn = document.createElement('div');
  lootBtn.className = 'checkbox';
  lootBtn.innerText = 'Loot the rewards!!';

  const levelBtn = document.createElement('div');
  levelBtn.className = 'checkbox';
  levelBtn.innerText = 'Everyone gain 1 level!';

  checkboxesDiv.appendChild(lootBtn);
  checkboxesDiv.appendChild(levelBtn);
  checkboxesDiv.style.display = 'flex';

  const container = document.querySelector('.container');
  const mainButton = document.getElementById('mainButton');
  mainButton.innerText = 'NEXT PLAYER';
  mainButton.disabled = true;
  mainButton.style.display = 'block';

  function checkDeep() {
    mainButton.disabled = !(lootBtn.classList.contains('checked') && levelBtn.classList.contains('checked'));
  }

  lootBtn.addEventListener('click', () => { lootBtn.classList.toggle('checked'); checkDeep(); });
  levelBtn.addEventListener('click', () => { levelBtn.classList.toggle('checked'); checkDeep(); });
}

function handleMainButton() {
  if (phaseMode === 'deep') { goToDawn(true); return; }

  if (!isNight) {
    if (slot === 0) { slot = 1; updateUI(); return; }
    if (slot < daySlots) { slot++; updateUI(); return; }
    showDuskChoice();
    return;
  } else {
    if (nightStep < nightSlots - 1) { showContinueNightInterstitial(); return; }
    else { showDeepOfNight(); return; }
  }
}

function resetGame() {
  if (!confirm("Are you sure you want to reset all game data?")) return;
  cycle = 1; slot = 0; isNight = false; nightStep = 0; phaseMode = null;
  cleanupTransientButtons();
  checkboxesDiv.innerHTML = '<div class="checkbox" id="actCheckbox">ACT</div><div class="checkbox" id="mapCheckbox">REVEAL</div>';
  actCheckbox = document.getElementById('actCheckbox');
  mapCheckbox = document.getElementById('mapCheckbox');
  actCheckbox.addEventListener('click', toggleCheckbox);
  mapCheckbox.addEventListener('click', toggleCheckbox);
  actCheckbox.classList.remove('checked');
  mapCheckbox.classList.remove('checked');
  checkboxesDiv.style.display = 'none';
  dayLabel.innerText = "DAWN of Cycle 1";
  slotLabel.innerText = "[0]";
  textArea.innerHTML = "All players gain <strong>one level!</strong> <br>All players regain all <strong>light mana!</strong>";
  mainButton.innerText = "CONTINUE";
  mainButton.disabled = false;
  mainButton.style.display = 'block';
  setContainerTheme('day');
}

/* Attach listeners + init */
mainButton.addEventListener('click', handleMainButton);
actCheckbox.addEventListener('click', toggleCheckbox);
mapCheckbox.addEventListener('click', toggleCheckbox);
updateUI();

// Preload other videos for faster navigation
function preloadVideos(videoUrls) {
  videoUrls.forEach(url => {
    const link = document.createElement('link');
    link.rel = 'preload';
    link.as = 'video';
    link.href = url;
    link.type = 'video/mp4';
    document.head.appendChild(link);
  });
}

// Preload videos after page load
document.addEventListener('DOMContentLoaded', function() {
  preloadVideos([
    'media/background.mp4',
    'media/138556-769988117_medium.mp4'
  ]);
});
</script>

</body>
</html>